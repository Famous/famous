/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
 *
 * @copyright Famous Industries, Inc. 2014
 */
define(function(t,i,e){function n(t){return[t.clientWidth,t.clientHeight]}function s(t){this.container=t,this._allocator=new a(t),this._node=new o,this._eventOutput=new r,this._size=n(this.container),this._perspectiveState=new c(0),this._perspective=void 0,this._nodeContext={allocator:this._allocator,transform:h.identity,opacity:1,origin:p,align:null,size:this._size},this._eventOutput.on("resize",function(){this.setSize(n(this.container))}.bind(this))}var o=t("./RenderNode"),r=t("./EventHandler"),a=t("./ElementAllocator"),h=t("./Transform"),c=t("famous/transitions/Transitionable"),p=[0,0];s.prototype.getAllocator=function(){return this._allocator},s.prototype.add=function(t){return this._node.add(t)},s.prototype.migrate=function(t){t!==this.container&&(this.container=t,this._allocator.migrate(t))},s.prototype.getSize=function(){return this._size},s.prototype.setSize=function(t){t||(t=n(this.container)),this._size[0]=t[0],this._size[1]=t[1]},s.prototype.update=function(t){t&&(t.transform&&(this._nodeContext.transform=t.transform),t.opacity&&(this._nodeContext.opacity=t.opacity),t.origin&&(this._nodeContext.origin=t.origin),t.align&&(this._nodeContext.align=t.align),t.size&&(this._nodeContext.size=t.size));var i=this._perspectiveState.get();i!==this._perspective&&(this.container.style.perspective=i?i.toFixed()+"px":"",this.container.style.webkitPerspective=i?i.toFixed():"",this._perspective=i),this._node.commit(this._nodeContext)},s.prototype.getPerspective=function(){return this._perspectiveState.get()},s.prototype.setPerspective=function(t,i,e){return this._perspectiveState.set(t,i,e)},s.prototype.emit=function(t,i){return this._eventOutput.emit(t,i)},s.prototype.on=function(t,i){return this._eventOutput.on(t,i)},s.prototype.removeListener=function(t,i){return this._eventOutput.removeListener(t,i)},s.prototype.pipe=function(t){return this._eventOutput.pipe(t)},s.prototype.unpipe=function(t){return this._eventOutput.unpipe(t)},e.exports=s}),define(function(t,i,e){function n(t){t||(t=document.createDocumentFragment()),this.container=t,this.detachedNodes={},this.nodeCount=0}n.prototype.migrate=function(t){var i=this.container;if(t!==i){if(i instanceof DocumentFragment)t.appendChild(i);else for(;i.hasChildNodes();)t.appendChild(i.removeChild(i.firstChild));this.container=t}},n.prototype.allocate=function(t){t=t.toLowerCase(),t in this.detachedNodes||(this.detachedNodes[t]=[]);var i,e=this.detachedNodes[t];return e.length>0?i=e.pop():(i=document.createElement(t),this.container.appendChild(i)),this.nodeCount++,i},n.prototype.deallocate=function(t){var i=t.nodeName.toLowerCase(),e=this.detachedNodes[i];e.push(t),this.nodeCount--},n.prototype.getNodeCount=function(){return this.nodeCount},e.exports=n}),define(function(t,i,e){function n(){v.runLoop?(p.step(),window.requestAnimationFrame(n)):_=!1}function s(){for(var t=0;t<u.length;t++)u[t].emit("resize");g.emit("resize")}var o,r,a=t("./Context"),h=t("./EventHandler"),c=t("./OptionsManager"),p={},u=[],l=[],f=[],d=Date.now(),_=!0,y={},g=new h,v={containerType:"div",containerClass:"famous-container",fpsCap:void 0,runLoop:!0},m=new c(v),O=10;p.step=function(){var t=Date.now();if(!(r&&r>t-d)){var i=0;for(o=t-d,d=t,g.emit("prerender"),i=0;i<l.length;i++)l[i].call(this);for(l.splice(0);f.length&&Date.now()-t<O;)f.shift().call(this);for(i=0;i<u.length;i++)u[i].update();g.emit("postrender")}},window.requestAnimationFrame(n),window.addEventListener("resize",s,!1),s(),window.addEventListener("touchmove",function(t){t.preventDefault()},!0),p.pipe=function(t){return t.subscribe instanceof Function?t.subscribe(p):g.pipe(t)},p.unpipe=function(t){return t.unsubscribe instanceof Function?t.unsubscribe(p):g.unpipe(t)},p.on=function(t,i){return t in y||(y[t]=g.emit.bind(g,t),document.body?document.body.addEventListener(t,y[t]):p.nextTick(function(t,i){document.body.addEventListener(t,i)}.bind(this,t,y[t]))),g.on(t,i)},p.emit=function(t,i){return g.emit(t,i)},p.removeListener=function(t,i){return g.removeListener(t,i)},p.getFPS=function(){return 1e3/o},p.setFPSCap=function(t){r=Math.floor(1e3/t)},p.getOptions=function(){return m.getOptions.apply(m,arguments)},p.setOptions=function(){return m.setOptions.apply(m,arguments)},p.createContext=function(t){var i=!1;t||(t=document.createElement(v.containerType),t.classList.add(v.containerClass),i=!0);var e=new a(t);return p.registerContext(e),i&&p.nextTick(function(t,i){document.body.appendChild(i),t.emit("resize")}.bind(this,e,t)),e},p.registerContext=function(t){return u.push(t),t},p.nextTick=function(t){l.push(t)},p.defer=function(t){f.push(t)},m.on("change",function(t){"fpsCap"===t.id?p.setFPSCap(t.value):"runLoop"===t.id&&!_&&t.value&&(_=!0,window.requestAnimationFrame(n))}),e.exports=p}),define(function(t,i,e){function n(t){return a[t]}function s(t,i){a[t]=i}function o(t){var i=a.length;return s(i,t),i}function r(t){s(t,null)}var a=[];e.exports={register:o,unregister:r,get:n,set:s}}),define(function(t,i,e){function n(){this.listeners={},this._owner=this}n.prototype.emit=function(t,i){var e=this.listeners[t];if(e)for(var n=0;n<e.length;n++)e[n].call(this._owner,i);return this},n.prototype.on=function(t,i){t in this.listeners||(this.listeners[t]=[]);var e=this.listeners[t].indexOf(i);return 0>e&&this.listeners[t].push(i),this},n.prototype.addListener=n.prototype.on,n.prototype.removeListener=function(t,i){var e=this.listeners[t].indexOf(i);return e>=0&&this.listeners[t].splice(e,1),this},n.prototype.bindThis=function(t){this._owner=t},e.exports=n}),define(function(t,i,e){function n(){s.apply(this,arguments),this.downstream=[],this.downstreamFn=[],this.upstream=[],this.upstreamListeners={}}var s=t("./EventEmitter");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.setInputHandler=function(t,i){t.trigger=i.trigger.bind(i),i.subscribe&&i.unsubscribe&&(t.subscribe=i.subscribe.bind(i),t.unsubscribe=i.unsubscribe.bind(i))},n.setOutputHandler=function(t,i){i instanceof n&&i.bindThis(t),t.pipe=i.pipe.bind(i),t.unpipe=i.unpipe.bind(i),t.on=i.on.bind(i),t.addListener=t.on,t.removeListener=i.removeListener.bind(i)},n.prototype.emit=function(t,i){s.prototype.emit.apply(this,arguments);var e=0;for(e=0;e<this.downstream.length;e++)this.downstream[e].trigger&&this.downstream[e].trigger(t,i);for(e=0;e<this.downstreamFn.length;e++)this.downstreamFn[e](t,i);return this},n.prototype.trigger=n.prototype.emit,n.prototype.pipe=function(t){if(t.subscribe instanceof Function)return t.subscribe(this);var i=t instanceof Function?this.downstreamFn:this.downstream,e=i.indexOf(t);return 0>e&&i.push(t),t instanceof Function?t("pipe",null):t.trigger&&t.trigger("pipe",null),t},n.prototype.unpipe=function(t){if(t.unsubscribe instanceof Function)return t.unsubscribe(this);var i=t instanceof Function?this.downstreamFn:this.downstream,e=i.indexOf(t);return e>=0?(i.splice(e,1),t instanceof Function?t("unpipe",null):t.trigger&&t.trigger("unpipe",null),t):!1},n.prototype.on=function(t){if(s.prototype.on.apply(this,arguments),!(t in this.upstreamListeners)){var i=this.trigger.bind(this,t);this.upstreamListeners[t]=i;for(var e=0;e<this.upstream.length;e++)this.upstream[e].on(t,i)}return this},n.prototype.addListener=n.prototype.on,n.prototype.subscribe=function(t){var i=this.upstream.indexOf(t);if(0>i){this.upstream.push(t);for(var e in this.upstreamListeners)t.on(e,this.upstreamListeners[e])}return this},n.prototype.unsubscribe=function(t){var i=this.upstream.indexOf(t);if(i>=0){this.upstream.splice(i,1);for(var e in this.upstreamListeners)t.removeListener(e,this.upstreamListeners[e])}return this},e.exports=n}),define(function(t,i,e){function n(t){r.call(this,t),this._shouldRecalculateSize=!1,this._container=document.createDocumentFragment(),this.context=new s(this._container),this.setContent(this._container),this._groupSize=[void 0,void 0]}var s=t("./Context"),o=t("./Transform"),r=t("./Surface");n.SIZE_ZERO=[0,0],n.prototype=Object.create(r.prototype),n.prototype.elementType="div",n.prototype.elementClass="famous-group",n.prototype.add=function(){return this.context.add.apply(this.context,arguments)},n.prototype.render=function(){return r.prototype.render.call(this)},n.prototype.deploy=function(t){this.context.migrate(t)},n.prototype.recall=function(){this._container=document.createDocumentFragment(),this.context.migrate(this._container)},n.prototype.commit=function(t){var i=t.transform,e=t.origin,s=t.opacity,a=t.size,h=r.prototype.commit.call(this,{allocator:t.allocator,transform:o.thenMove(i,[-e[0]*a[0],-e[1]*a[1],0]),opacity:s,origin:e,size:n.SIZE_ZERO});return(a[0]!==this._groupSize[0]||a[1]!==this._groupSize[1])&&(this._groupSize[0]=a[0],this._groupSize[1]=a[1],this.context.setSize(a)),this.context.update({transform:o.translate(-e[0]*a[0],-e[1]*a[1],0),origin:e,size:a}),h},e.exports=n}),define(function(t,i,e){function n(t){this._transformGetter=null,this._opacityGetter=null,this._originGetter=null,this._alignGetter=null,this._sizeGetter=null,this._legacyStates={},this._output={transform:o.identity,opacity:1,origin:null,align:null,size:null,target:null},t&&(t.transform&&this.transformFrom(t.transform),void 0!==t.opacity&&this.opacityFrom(t.opacity),t.origin&&this.originFrom(t.origin),t.align&&this.alignFrom(t.align),t.size&&this.sizeFrom(t.size))}function s(){this._transformGetter&&(this._output.transform=this._transformGetter()),this._opacityGetter&&(this._output.opacity=this._opacityGetter()),this._originGetter&&(this._output.origin=this._originGetter()),this._alignGetter&&(this._output.align=this._alignGetter()),this._sizeGetter&&(this._output.size=this._sizeGetter())}var o=t("./Transform"),r=t("famous/transitions/Transitionable"),a=t("famous/transitions/TransitionableTransform");n.prototype.transformFrom=function(t){return t instanceof Function?this._transformGetter=t:t instanceof Object&&t.get?this._transformGetter=t.get.bind(t):(this._transformGetter=null,this._output.transform=t),this},n.prototype.opacityFrom=function(t){return t instanceof Function?this._opacityGetter=t:t instanceof Object&&t.get?this._opacityGetter=t.get.bind(t):(this._opacityGetter=null,this._output.opacity=t),this},n.prototype.originFrom=function(t){return t instanceof Function?this._originGetter=t:t instanceof Object&&t.get?this._originGetter=t.get.bind(t):(this._originGetter=null,this._output.origin=t),this},n.prototype.alignFrom=function(t){return t instanceof Function?this._alignGetter=t:t instanceof Object&&t.get?this._alignGetter=t.get.bind(t):(this._alignGetter=null,this._output.align=t),this},n.prototype.sizeFrom=function(t){return t instanceof Function?this._sizeGetter=t:t instanceof Object&&t.get?this._sizeGetter=t.get.bind(t):(this._sizeGetter=null,this._output.size=t),this},n.prototype.setTransform=function(t,i,e){return i||this._legacyStates.transform?(this._legacyStates.transform||(this._legacyStates.transform=new a(this._output.transform)),this._transformGetter||this.transformFrom(this._legacyStates.transform),this._legacyStates.transform.set(t,i,e),this):this.transformFrom(t)},n.prototype.setOpacity=function(t,i,e){return i||this._legacyStates.opacity?(this._legacyStates.opacity||(this._legacyStates.opacity=new r(this._output.opacity)),this._opacityGetter||this.opacityFrom(this._legacyStates.opacity),this._legacyStates.opacity.set(t,i,e)):this.opacityFrom(t)},n.prototype.setOrigin=function(t,i,e){return i||this._legacyStates.origin?(this._legacyStates.origin||(this._legacyStates.origin=new r(this._output.origin||[0,0])),this._originGetter||this.originFrom(this._legacyStates.origin),this._legacyStates.origin.set(t,i,e),this):this.originFrom(t)},n.prototype.setAlign=function(t,i,e){return i||this._legacyStates.align?(this._legacyStates.align||(this._legacyStates.align=new r(this._output.align||[0,0])),this._alignGetter||this.alignFrom(this._legacyStates.align),this._legacyStates.align.set(t,i,e),this):this.alignFrom(t)},n.prototype.setSize=function(t,i,e){return t&&(i||this._legacyStates.size)?(this._legacyStates.size||(this._legacyStates.size=new r(this._output.size||[0,0])),this._sizeGetter||this.sizeFrom(this._legacyStates.size),this._legacyStates.size.set(t,i,e),this):this.sizeFrom(t)},n.prototype.halt=function(){this._legacyStates.transform&&this._legacyStates.transform.halt(),this._legacyStates.opacity&&this._legacyStates.opacity.halt(),this._legacyStates.origin&&this._legacyStates.origin.halt(),this._legacyStates.align&&this._legacyStates.align.halt(),this._legacyStates.size&&this._legacyStates.size.halt(),this._transformGetter=null,this._opacityGetter=null,this._originGetter=null,this._alignGetter=null,this._sizeGetter=null},n.prototype.getTransform=function(){return this._transformGetter()},n.prototype.getFinalTransform=function(){return this._legacyStates.transform?this._legacyStates.transform.getFinal():this._output.transform},n.prototype.getOpacity=function(){return this._opacityGetter()},n.prototype.getOrigin=function(){return this._originGetter()},n.prototype.getAlign=function(){return this._alignGetter()},n.prototype.getSize=function(){return this._sizeGetter?this._sizeGetter():this._output.size},n.prototype.modify=function(t){return s.call(this),this._output.target=t,this._output},e.exports=n}),define(function(t,i,e){function n(t){this._value=t,this.eventOutput=null}function s(){this.eventOutput=new o,this.eventOutput.bindThis(this),o.setOutputHandler(this,this.eventOutput)}var o=t("./EventHandler");n.patch=function(t){for(var i=new n(t),e=1;e<arguments.length;e++)i.patch(arguments[e]);return t},n.prototype.patch=function(){for(var t=this._value,i=0;i<arguments.length;i++){var e=arguments[i];for(var n in e)n in t&&e[n]&&e[n].constructor===Object&&t[n]&&t[n].constructor===Object?(t.hasOwnProperty(n)||(t[n]=Object.create(t[n])),this.key(n).patch(e[n]),this.eventOutput&&this.eventOutput.emit("change",{id:n,value:this.key(n).value()})):this.set(n,e[n])}return this},n.prototype.setOptions=n.prototype.patch,n.prototype.key=function(t){var i=new n(this._value[t]);return(!(i._value instanceof Object)||i._value instanceof Array)&&(i._value={}),i},n.prototype.get=function(t){return this._value[t]},n.prototype.getOptions=n.prototype.get,n.prototype.set=function(t,i){var e=this.get(t);return this._value[t]=i,this.eventOutput&&i!==e&&this.eventOutput.emit("change",{id:t,value:i}),this},n.prototype.value=function(){return this._value},n.prototype.on=function(){return s.call(this),this.on.apply(this,arguments)},n.prototype.removeListener=function(){return s.call(this),this.removeListener.apply(this,arguments)},n.prototype.pipe=function(){return s.call(this),this.pipe.apply(this,arguments)},n.prototype.unpipe=function(){return s.call(this),this.unpipe.apply(this,arguments)},e.exports=n}),define(function(t,i,e){function n(t){this._object=null,this._child=null,this._hasMultipleChildren=!1,this._isRenderable=!1,this._isModifier=!1,this._resultCache={},this._prevResults={},this._childResult=null,t&&this.set(t)}function s(t,i,e){for(var n=r.parse(t,i),a=Object.keys(n),h=0;h<a.length;h++){var c=a[h],p=o.get(c),u=n[c];u.allocator=i.allocator;var l=p.commit(u);l?s(l,i,e):e[c]=u}}var o=t("./Entity"),r=t("./SpecParser");n.prototype.add=function(t){var i=t instanceof n?t:new n(t);return this._child instanceof Array?this._child.push(i):this._child?(this._child=[this._child,i],this._hasMultipleChildren=!0,this._childResult=[]):this._child=i,i},n.prototype.get=function(){return this._object||(this._hasMultipleChildren?null:this._child?this._child.get():null)},n.prototype.set=function(t){return this._childResult=null,this._hasMultipleChildren=!1,this._isRenderable=t.render?!0:!1,this._isModifier=t.modify?!0:!1,this._object=t,this._child=null,t instanceof n?t:this},n.prototype.getSize=function(){var t=null,i=this.get();return i&&i.getSize&&(t=i.getSize()),!t&&this._child&&this._child.getSize&&(t=this._child.getSize()),t},n.prototype.commit=function(t){for(var i=Object.keys(this._prevResults),e=0;e<i.length;e++){var n=i[e];if(void 0===this._resultCache[n]){var r=o.get(n);r.cleanup&&r.cleanup(t.allocator)}}this._prevResults=this._resultCache,this._resultCache={},s(this.render(),t,this._resultCache)},n.prototype.render=function(){if(this._isRenderable)return this._object.render();var t=null;if(this._hasMultipleChildren){t=this._childResult;for(var i=this._child,e=0;e<i.length;e++)t[e]=i[e].render()}else this._child&&(t=this._child.render());return this._isModifier?this._object.modify(t):t},e.exports=n}),define(function(t,i,e){function n(t){this.id=null,this._objects=null,this.node=new p,this._definition=null,t&&this.load(t)}function s(t){for(var i in u)if(i in t){var e=t[i];return e instanceof Array||(e=[e]),u[i].apply(this,e)}}function o(t){var i=t.transform,e=t.opacity,n=t.origin,o=t.align,r=t.size,a=h.identity;if(i instanceof Array)if(16===i.length&&"number"==typeof i[0])a=i;else for(var p=0;p<i.length;p++)a=h.multiply(a,s(i[p]));else i instanceof Object&&(a=s(i));var u=new c({transform:a,opacity:e,origin:n,align:o,size:r});return u}function r(t){for(var i=new p,e=0;e<t.length;e++){var n=a.call(this,t[e]);n&&i.add(n)}return i}function a(t){var i,e;if(t instanceof Array)i=r.call(this,t);else if(e=this._objects.length,t.render&&t.render instanceof Function)i=t;else if(t.target){var n=a.call(this,t.target),s=o.call(this,t);i=new p(s),i.add(n),t.id&&(this.id[t.id]=s)}else t.id&&(i=new p,this.id[t.id]=i);return this._objects[e]=i,i}var h=t("./Transform"),c=t("./Modifier"),p=t("./RenderNode"),u={translate:h.translate,rotate:h.rotate,rotateX:h.rotateX,rotateY:h.rotateY,rotateZ:h.rotateZ,rotateAxis:h.rotateAxis,scale:h.scale,skew:h.skew,matrix3d:function(){return arguments}};n.prototype.create=function(){return new n(this._definition)},n.prototype.load=function(t){this._definition=t,this.id={},this._objects=[],this.node.set(a.call(this,t))},n.prototype.add=function(){return this.node.add.apply(this.node,arguments)},n.prototype.render=function(){return this.node.render.apply(this.node,arguments)},e.exports=n}),define(function(t,i,e){function n(){this.result={}}function s(t,i){return[t[0]*i[0]+t[1]*i[4]+t[2]*i[8],t[0]*i[1]+t[1]*i[5]+t[2]*i[9],t[0]*i[2]+t[1]*i[6]+t[2]*i[10]]}var o=t("./Transform");n._instance=new n,n.parse=function(t,i){return n._instance.parse(t,i)},n.prototype.parse=function(t,i){return this.reset(),this._parseSpec(t,i,o.identity),this.result},n.prototype.reset=function(){this.result={}};var r=[0,0];n.prototype._parseSpec=function(t,i,e){var n,a,h,c,p,u,l;if("number"==typeof t){if(n=t,h=i.transform,u=i.align||i.origin,i.size&&u&&(u[0]||u[1])){var f=[u[0]*i.size[0],u[1]*i.size[1],0];h=o.thenMove(h,s(f,e))}this.result[n]={transform:h,opacity:i.opacity,origin:i.origin||r,align:i.align||i.origin||r,size:i.size}}else{if(!t)return;if(t instanceof Array)for(var d=0;d<t.length;d++)this._parseSpec(t[d],i,e);else{a=t.target,h=i.transform,c=i.opacity,p=i.origin,u=i.align,l=i.size;var _=e;if(void 0!==t.opacity&&(c=i.opacity*t.opacity),t.transform&&(h=o.multiply(i.transform,t.transform)),t.origin&&(p=t.origin,_=i.transform),t.align&&(u=t.align),t.size){var y=i.size;l=[void 0!==t.size[0]?t.size[0]:y[0],void 0!==t.size[1]?t.size[1]:y[1]],y&&(u||(u=p),u&&(u[0]||u[1])&&(h=o.thenMove(h,s([u[0]*y[0],u[1]*y[1],0],e))),p&&(p[0]||p[1])&&(h=o.moveThen([-p[0]*l[0],-p[1]*l[1],0],h))),_=i.transform,p=null,u=null}this._parseSpec(a,{transform:h,opacity:c,origin:p,align:u,size:l},_)}}},e.exports=n}),define(function(t,i,e){function n(t){this.options={},this.properties={},this.content="",this.classList=[],this.size=null,this._classesDirty=!0,this._stylesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._dirtyClasses=[],this._matrix=null,this._opacity=1,this._origin=null,this._size=null,this.eventForwarder=function(t){this.emit(t.type,t)}.bind(this),this.eventHandler=new f,this.eventHandler.bindThis(this),this.id=l.register(this),t&&this.setOptions(t),this._currTarget=null}function s(t){for(var i in this.eventHandler.listeners)t.addEventListener(i,this.eventForwarder)}function o(t){for(var i in this.eventHandler.listeners)t.removeEventListener(i,this.eventForwarder)}function r(t){for(var i=0;i<this._dirtyClasses.length;i++)t.classList.remove(this._dirtyClasses[i]);this._dirtyClasses=[]}function a(t){for(var i in this.properties)t.style[i]=this.properties[i]}function h(t){for(var i in this.properties)t.style[i]=""}function c(t){t[12]=Math.round(t[12]*_)/_,t[13]=Math.round(t[13]*_)/_;for(var i="matrix3d(",e=0;15>e;e++)i+=t[e]<1e-6&&t[e]>-1e-6?"0,":t[e]+",";return i+=t[15]+")"}function p(t){return 100*t[0]+"% "+100*t[1]+"%"}function u(t,i){return t&&i?t[0]!==i[0]||t[1]!==i[1]:t!==i}var l=t("./Entity"),f=t("./EventHandler"),d=t("./Transform"),_=window.devicePixelRatio||1,y=void 0!==document.createElement("div").style.webkitTransform;n.prototype.elementType="div",n.prototype.elementClass="famous-surface",n.prototype.on=function(t,i){this._currTarget&&this._currTarget.addEventListener(t,this.eventForwarder),this.eventHandler.on(t,i)},n.prototype.removeListener=function(t,i){this.eventHandler.removeListener(t,i)},n.prototype.emit=function(t,i){i&&!i.origin&&(i.origin=this);var e=this.eventHandler.emit(t,i);return e&&i&&i.stopPropagation&&i.stopPropagation(),e},n.prototype.pipe=function(t){return this.eventHandler.pipe(t)},n.prototype.unpipe=function(t){return this.eventHandler.unpipe(t)},n.prototype.render=function(){return this.id},n.prototype.setProperties=function(t){for(var i in t)this.properties[i]=t[i];this._stylesDirty=!0},n.prototype.getProperties=function(){return this.properties},n.prototype.addClass=function(t){this.classList.indexOf(t)<0&&(this.classList.push(t),this._classesDirty=!0)},n.prototype.removeClass=function(t){var i=this.classList.indexOf(t);i>=0&&(this._dirtyClasses.push(this.classList.splice(i,1)[0]),this._classesDirty=!0)},n.prototype.setClasses=function(t){var i=0,e=[];for(i=0;i<this.classList.length;i++)t.indexOf(this.classList[i])<0&&e.push(this.classList[i]);for(i=0;i<e.length;i++)this.removeClass(e[i]);for(i=0;i<t.length;i++)this.addClass(t[i])},n.prototype.getClassList=function(){return this.classList},n.prototype.setContent=function(t){this.content!==t&&(this.content=t,this._contentDirty=!0)},n.prototype.getContent=function(){return this.content},n.prototype.setOptions=function(t){t.size&&this.setSize(t.size),t.classes&&this.setClasses(t.classes),t.properties&&this.setProperties(t.properties),t.content&&this.setContent(t.content)};var g;g=navigator.userAgent.toLowerCase().indexOf("firefox")>-1?function(t,i){t.style.zIndex=1e6*i[14]|0,t.style.transform=c(i)}:y?function(t,i){t.style.webkitTransform=c(i)}:function(t,i){t.style.transform=c(i)};var v=y?function(t,i){t.style.webkitTransformOrigin=p(i)}:function(t,i){t.style.transformOrigin=p(i)},m=y?function(t){t.style.webkitTransform="scale3d(0.0001,0.0001,1)",t.style.opacity=0}:function(t){t.style.transform="scale3d(0.0001,0.0001,1)",t.style.opacity=0};n.prototype.setup=function(t){var i=t.allocate(this.elementType);if(this.elementClass)if(this.elementClass instanceof Array)for(var e=0;e<this.elementClass.length;e++)i.classList.add(this.elementClass[e]);else i.classList.add(this.elementClass);i.style.display="",s.call(this,i),this._currTarget=i,this._stylesDirty=!0,this._classesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._matrix=null,this._opacity=void 0,this._origin=null,this._size=null},n.prototype.commit=function(t){this._currTarget||this.setup(t.allocator);var i=this._currTarget,e=t.transform,n=t.opacity,s=t.origin,o=t.size;if(this._classesDirty){r.call(this,i);for(var h=this.getClassList(),c=0;c<h.length;c++)i.classList.add(h[c]);this._classesDirty=!1}if(this._stylesDirty&&(a.call(this,i),this._stylesDirty=!1),this._contentDirty&&(this.deploy(i),this.eventHandler.emit("deploy"),this._contentDirty=!1),this.size){var p=o;o=[this.size[0],this.size[1]],void 0===o[0]&&p[0]&&(o[0]=p[0]),void 0===o[1]&&p[1]&&(o[1]=p[1])}if(o[0]===!0&&(o[0]=i.clientWidth),o[1]===!0&&(o[1]=i.clientHeight),u(this._size,o)&&(this._size||(this._size=[0,0]),this._size[0]=o[0],this._size[1]=o[1],this._sizeDirty=!0),!e&&this._matrix)return this._matrix=null,this._opacity=0,void m(i);if(this._opacity!==n&&(this._opacity=n,i.style.opacity=n>=1?"0.999999":n),u(this._origin,s)||d.notEquals(this._matrix,e)||this._sizeDirty){e||(e=d.identity),this._matrix=e;var l=e;s&&(this._origin||(this._origin=[0,0]),this._origin[0]=s[0],this._origin[1]=s[1],l=d.thenMove(e,[-this._size[0]*s[0],-this._size[1]*s[1],0]),v(i,s)),g(i,l)}this._sizeDirty&&(this._size&&(i.style.width=this.size&&this.size[0]===!0?"":this._size[0]+"px",i.style.height=this.size&&this.size[1]===!0?"":this._size[1]+"px"),this._sizeDirty=!1)},n.prototype.cleanup=function(t){var i=0,e=this._currTarget;this.eventHandler.emit("recall"),this.recall(e),e.style.display="none",e.style.width="",e.style.height="",this._size=null,h.call(this,e);var n=this.getClassList();for(r.call(this,e),i=0;i<n.length;i++)e.classList.remove(n[i]);if(this.elementClass)if(this.elementClass instanceof Array)for(i=0;i<this.elementClass.length;i++)e.classList.remove(this.elementClass[i]);else e.classList.remove(this.elementClass);o.call(this,e),this._currTarget=null,t.deallocate(e),m(e)},n.prototype.deploy=function(t){var i=this.getContent();if(i instanceof Node){for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(i)}else t.innerHTML=i},n.prototype.recall=function(t){for(var i=document.createDocumentFragment();t.hasChildNodes();)i.appendChild(t.firstChild);this.setContent(i)},n.prototype.getSize=function(t){return t?this._size:this.size||this._size},n.prototype.setSize=function(t){this.size=t?[t[0],t[1]]:null,this._sizeDirty=!0},e.exports=n}),define(function(t,i,e){function n(t){this._node=new r,this._eventInput=new s,this._eventOutput=new s,s.setInputHandler(this,this._eventInput),s.setOutputHandler(this,this._eventOutput),this.options=Object.create(this.constructor.DEFAULT_OPTIONS||n.DEFAULT_OPTIONS),this._optionsManager=new o(this.options),t&&this.setOptions(t)}var s=t("./EventHandler"),o=t("./OptionsManager"),r=t("./RenderNode");n.DEFAULT_OPTIONS={},n.prototype.getOptions=function(){return this._optionsManager.value()},n.prototype.setOptions=function(t){this._optionsManager.patch(t)},n.prototype.add=function(){return this._node.add.apply(this._node,arguments)},n.prototype._add=n.prototype.add,n.prototype.render=function(){return this._node.render()},n.prototype.getSize=function(){return this._node&&this._node.getSize?this._node.getSize.apply(this._node,arguments)||this.options.size:this.options.size},e.exports=n}),define(function(t,i,e){function n(t){return 2===t.length?t[0]*t[0]+t[1]*t[1]:t[0]*t[0]+t[1]*t[1]+t[2]*t[2]}function s(t){return Math.sqrt(n(t))}function o(t){return 0>t?-1:1}var r={};r.precision=1e-6,r.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r.multiply4x4=function(t,i){return[t[0]*i[0]+t[4]*i[1]+t[8]*i[2]+t[12]*i[3],t[1]*i[0]+t[5]*i[1]+t[9]*i[2]+t[13]*i[3],t[2]*i[0]+t[6]*i[1]+t[10]*i[2]+t[14]*i[3],t[3]*i[0]+t[7]*i[1]+t[11]*i[2]+t[15]*i[3],t[0]*i[4]+t[4]*i[5]+t[8]*i[6]+t[12]*i[7],t[1]*i[4]+t[5]*i[5]+t[9]*i[6]+t[13]*i[7],t[2]*i[4]+t[6]*i[5]+t[10]*i[6]+t[14]*i[7],t[3]*i[4]+t[7]*i[5]+t[11]*i[6]+t[15]*i[7],t[0]*i[8]+t[4]*i[9]+t[8]*i[10]+t[12]*i[11],t[1]*i[8]+t[5]*i[9]+t[9]*i[10]+t[13]*i[11],t[2]*i[8]+t[6]*i[9]+t[10]*i[10]+t[14]*i[11],t[3]*i[8]+t[7]*i[9]+t[11]*i[10]+t[15]*i[11],t[0]*i[12]+t[4]*i[13]+t[8]*i[14]+t[12]*i[15],t[1]*i[12]+t[5]*i[13]+t[9]*i[14]+t[13]*i[15],t[2]*i[12]+t[6]*i[13]+t[10]*i[14]+t[14]*i[15],t[3]*i[12]+t[7]*i[13]+t[11]*i[14]+t[15]*i[15]]},r.multiply=function(t,i){return[t[0]*i[0]+t[4]*i[1]+t[8]*i[2],t[1]*i[0]+t[5]*i[1]+t[9]*i[2],t[2]*i[0]+t[6]*i[1]+t[10]*i[2],0,t[0]*i[4]+t[4]*i[5]+t[8]*i[6],t[1]*i[4]+t[5]*i[5]+t[9]*i[6],t[2]*i[4]+t[6]*i[5]+t[10]*i[6],0,t[0]*i[8]+t[4]*i[9]+t[8]*i[10],t[1]*i[8]+t[5]*i[9]+t[9]*i[10],t[2]*i[8]+t[6]*i[9]+t[10]*i[10],0,t[0]*i[12]+t[4]*i[13]+t[8]*i[14]+t[12],t[1]*i[12]+t[5]*i[13]+t[9]*i[14]+t[13],t[2]*i[12]+t[6]*i[13]+t[10]*i[14]+t[14],1]},r.thenMove=function(t,i){return i[2]||(i[2]=0),[t[0],t[1],t[2],0,t[4],t[5],t[6],0,t[8],t[9],t[10],0,t[12]+i[0],t[13]+i[1],t[14]+i[2],1]},r.moveThen=function(t,i){t[2]||(t[2]=0);var e=t[0]*i[0]+t[1]*i[4]+t[2]*i[8],n=t[0]*i[1]+t[1]*i[5]+t[2]*i[9],s=t[0]*i[2]+t[1]*i[6]+t[2]*i[10];return r.thenMove(i,[e,n,s])},r.translate=function(t,i,e){return void 0===e&&(e=0),[1,0,0,0,0,1,0,0,0,0,1,0,t,i,e,1]},r.thenScale=function(t,i){return[i[0]*t[0],i[1]*t[1],i[2]*t[2],0,i[0]*t[4],i[1]*t[5],i[2]*t[6],0,i[0]*t[8],i[1]*t[9],i[2]*t[10],0,i[0]*t[12],i[1]*t[13],i[2]*t[14],1]},r.scale=function(t,i,e){return void 0===e&&(e=1),[t,0,0,0,0,i,0,0,0,0,e,0,0,0,0,1]},r.rotateX=function(t){var i=Math.cos(t),e=Math.sin(t);return[1,0,0,0,0,i,e,0,0,-e,i,0,0,0,0,1]},r.rotateY=function(t){var i=Math.cos(t),e=Math.sin(t);return[i,0,-e,0,0,1,0,0,e,0,i,0,0,0,0,1]},r.rotateZ=function(t){var i=Math.cos(t),e=Math.sin(t);return[i,e,0,0,-e,i,0,0,0,0,1,0,0,0,0,1]},r.rotate=function(t,i,e){var n=Math.cos(t),s=Math.sin(t),o=Math.cos(i),r=Math.sin(i),a=Math.cos(e),h=Math.sin(e),c=[o*a,n*h+s*r*a,s*h-n*r*a,0,-o*h,n*a-s*r*h,s*a+n*r*h,0,r,-s*o,n*o,0,0,0,0,1];return c},r.rotateAxis=function(t,i){var e=Math.sin(i),n=Math.cos(i),s=1-n,o=t[0]*t[0]*s,r=t[0]*t[1]*s,a=t[0]*t[2]*s,h=t[1]*t[1]*s,c=t[1]*t[2]*s,p=t[2]*t[2]*s,u=t[0]*e,l=t[1]*e,f=t[2]*e,d=[o+n,r+f,a-l,0,r-f,h+n,c+u,0,a+l,c-u,p+n,0,0,0,0,1];return d},r.aboutOrigin=function(t,i){var e=t[0]-(t[0]*i[0]+t[1]*i[4]+t[2]*i[8]),n=t[1]-(t[0]*i[1]+t[1]*i[5]+t[2]*i[9]),s=t[2]-(t[0]*i[2]+t[1]*i[6]+t[2]*i[10]);return r.thenMove(i,[e,n,s])},r.skew=function(t,i,e){return[1,0,0,0,Math.tan(e),1,0,0,Math.tan(i),Math.tan(t),1,0,0,0,0,1]},r.skewX=function(t){return[1,0,0,0,Math.tan(t),1,0,0,0,0,1,0,0,0,0,1]},r.skewY=function(t){return[1,Math.tan(t),0,0,0,1,0,0,0,0,1,0,0,0,0,1]},r.perspective=function(t){return[1,0,0,0,0,1,0,0,0,0,1,-1/t,0,0,0,1]},r.getTranslate=function(t){return[t[12],t[13],t[14]]},r.inverse=function(t){var i=t[5]*t[10]-t[6]*t[9],e=t[4]*t[10]-t[6]*t[8],n=t[4]*t[9]-t[5]*t[8],s=t[1]*t[10]-t[2]*t[9],o=t[0]*t[10]-t[2]*t[8],r=t[0]*t[9]-t[1]*t[8],a=t[1]*t[6]-t[2]*t[5],h=t[0]*t[6]-t[2]*t[4],c=t[0]*t[5]-t[1]*t[4],p=t[0]*i-t[1]*e+t[2]*n,u=1/p,l=[u*i,-u*s,u*a,0,-u*e,u*o,-u*h,0,u*n,-u*r,u*c,0,0,0,0,1];return l[12]=-t[12]*l[0]-t[13]*l[4]-t[14]*l[8],l[13]=-t[12]*l[1]-t[13]*l[5]-t[14]*l[9],l[14]=-t[12]*l[2]-t[13]*l[6]-t[14]*l[10],l},r.transpose=function(t){return[t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15]]},r.interpret=function(t){var i=[t[0],t[1],t[2]],e=o(i[0]),a=s(i),h=[i[0]+e*a,i[1],i[2]],c=2/n(h);if(c>=1/0)return{translate:r.getTranslate(t),rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]};var p=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];p[0]=1-c*h[0]*h[0],p[5]=1-c*h[1]*h[1],p[10]=1-c*h[2]*h[2],p[1]=-c*h[0]*h[1],p[2]=-c*h[0]*h[2],p[6]=-c*h[1]*h[2],p[4]=p[1],p[8]=p[2],p[9]=p[6];var u=r.multiply(p,t),l=[u[5],u[6]],f=o(l[0]),d=s(l),_=[l[0]+f*d,l[1]],y=2/n(_),g=[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];g[5]=1-y*_[0]*_[0],g[10]=1-y*_[1]*_[1],g[6]=-y*_[0]*_[1],g[9]=g[6];var v=r.multiply(g,p),m=r.multiply(v,t),O=r.scale(m[0]<0?-1:1,m[5]<0?-1:1,m[10]<0?-1:1);m=r.multiply(m,O),v=r.multiply(O,v);var T={};return T.translate=r.getTranslate(t),T.rotate=[Math.atan2(-v[6],v[10]),Math.asin(v[2]),Math.atan2(-v[1],v[0])],T.rotate[0]||(T.rotate[0]=0,T.rotate[2]=Math.atan2(v[4],v[5])),T.scale=[m[0],m[5],m[10]],T.skew=[Math.atan2(m[9],T.scale[2]),Math.atan2(m[8],T.scale[2]),Math.atan2(m[4],T.scale[0])],Math.abs(T.rotate[0])+Math.abs(T.rotate[2])>1.5*Math.PI&&(T.rotate[1]=Math.PI-T.rotate[1],T.rotate[1]>Math.PI&&(T.rotate[1]-=2*Math.PI),T.rotate[1]<-Math.PI&&(T.rotate[1]+=2*Math.PI),T.rotate[0]<0?T.rotate[0]+=Math.PI:T.rotate[0]-=Math.PI,T.rotate[2]<0?T.rotate[2]+=Math.PI:T.rotate[2]-=Math.PI),T},r.average=function(t,i,e){e=void 0===e?.5:e;for(var n=r.interpret(t),s=r.interpret(i),o={translate:[0,0,0],rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]},a=0;3>a;a++)o.translate[a]=(1-e)*n.translate[a]+e*s.translate[a],o.rotate[a]=(1-e)*n.rotate[a]+e*s.rotate[a],o.scale[a]=(1-e)*n.scale[a]+e*s.scale[a],o.skew[a]=(1-e)*n.skew[a]+e*s.skew[a];
return r.build(o)},r.build=function(t){var i=r.scale(t.scale[0],t.scale[1],t.scale[2]),e=r.skew(t.skew[0],t.skew[1],t.skew[2]),n=r.rotate(t.rotate[0],t.rotate[1],t.rotate[2]);return r.thenMove(r.multiply(r.multiply(n,e),i),t.translate)},r.equals=function(t,i){return!r.notEquals(t,i)},r.notEquals=function(t,i){return t===i?!1:!(t&&i)||t[12]!==i[12]||t[13]!==i[13]||t[14]!==i[14]||t[0]!==i[0]||t[1]!==i[1]||t[2]!==i[2]||t[4]!==i[4]||t[5]!==i[5]||t[6]!==i[6]||t[8]!==i[8]||t[9]!==i[9]||t[10]!==i[10]},r.normalizeRotation=function(t){var i=t.slice(0);for((i[0]===.5*Math.PI||i[0]===.5*-Math.PI)&&(i[0]=-i[0],i[1]=Math.PI-i[1],i[2]-=Math.PI),i[0]>.5*Math.PI&&(i[0]=i[0]-Math.PI,i[1]=Math.PI-i[1],i[2]-=Math.PI),i[0]<.5*-Math.PI&&(i[0]=i[0]+Math.PI,i[1]=-Math.PI-i[1],i[2]-=Math.PI);i[1]<-Math.PI;)i[1]+=2*Math.PI;for(;i[1]>=Math.PI;)i[1]-=2*Math.PI;for(;i[2]<-Math.PI;)i[2]+=2*Math.PI;for(;i[2]>=Math.PI;)i[2]-=2*Math.PI;return i},r.inFront=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,.001,1],r.behind=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,-.001,1],e.exports=r}),define(function(t,i,e){function n(t){t||(t=[]),t instanceof Array&&(t={array:t}),this._=null,this.index=t.index||0,t.array?this._=new this.constructor.Backing(t.array):t._&&(this._=t._),this.index===this._.firstIndex&&(this._.firstNode=this),this.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=this),void 0!==t.loop&&(this._.loop=t.loop),this._previousNode=null,this._nextNode=null}n.Backing=function(t){this.array=t,this.firstIndex=0,this.loop=!1,this.firstNode=null,this.lastNode=null},n.Backing.prototype.getValue=function(t){var i=t-this.firstIndex;return 0>i||i>=this.array.length?null:this.array[i]},n.Backing.prototype.setValue=function(t,i){this.array[t-this.firstIndex]=i},n.Backing.prototype.reindex=function(t,i,e){if(this.array[0]){for(var n=0,s=this.firstIndex,o=e-i,r=this.firstNode;t-1>s;)r=r.getNext(),s++;var a=r;for(n=0;i>n;n++)r=r.getNext(),r&&(r._previousNode=a);var h=r?r.getNext():null;for(a._nextNode=null,r=a,n=0;e>n;n++)r=r.getNext();if(s+=e,r!==h&&(r._nextNode=h,h&&(h._previousNode=r)),h)for(r=h,s++;r&&s<this.array.length+this.firstIndex;)r._nextNode?r.index+=o:r.index=s,r=r.getNext(),s++}},n.prototype.getPrevious=function(){return this.index===this._.firstIndex?this._.loop?(this._previousNode=this._.lastNode||new this.constructor({_:this._,index:this._.firstIndex+this._.array.length-1}),this._previousNode._nextNode=this):this._previousNode=null:this._previousNode||(this._previousNode=new this.constructor({_:this._,index:this.index-1}),this._previousNode._nextNode=this),this._previousNode},n.prototype.getNext=function(){return this.index===this._.firstIndex+this._.array.length-1?this._.loop?(this._nextNode=this._.firstNode||new this.constructor({_:this._,index:this._.firstIndex}),this._nextNode._previousNode=this):this._nextNode=null:this._nextNode||(this._nextNode=new this.constructor({_:this._,index:this.index+1}),this._nextNode._previousNode=this),this._nextNode},n.prototype.getIndex=function(){return this.index},n.prototype.toString=function(){return""+this.index},n.prototype.unshift=function(){this._.array.unshift.apply(this._.array,arguments),this._.firstIndex-=arguments.length},n.prototype.push=function(){this._.array.push.apply(this._.array,arguments)},n.prototype.splice=function(t,i){var e=Array.prototype.slice.call(arguments,2);this._.array.splice.apply(this._.array,[t-this._.firstIndex,i].concat(e)),this._.reindex(t,i,e.length)},n.prototype.swap=function(t){var i=t.get(),e=this.get();this._.setValue(this.index,i),this._.setValue(t.index,e);var n=this._previousNode,s=this._nextNode,o=this.index,r=t._previousNode,a=t._nextNode,h=t.index;this.index=h,this._previousNode=r===this?t:r,this._previousNode&&(this._previousNode._nextNode=this),this._nextNode=a===this?t:a,this._nextNode&&(this._nextNode._previousNode=this),t.index=o,t._previousNode=n===t?this:n,t._previousNode&&(t._previousNode._nextNode=t),t._nextNode=s===t?this:s,t._nextNode&&(t._nextNode._previousNode=t),this.index===this._.firstIndex?this._.firstNode=this:this.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=this),t.index===this._.firstIndex?this._.firstNode=t:t.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=t)},n.prototype.get=function(){return this._.getValue(this.index)},n.prototype.getSize=function(){var t=this.get();return t?t.getSize():null},n.prototype.render=function(){var t=this.get();return t?t.render.apply(t,arguments):null},e.exports=n}),define(function(t,i,e){function n(t){this.dispatchers={},this.currMode=void 0,this.setMode(t)}var s=t("famous/core/EventHandler");n.prototype.setMode=function(t){if(t!==this.currMode){var i=this.currMode;this.dispatchers[this.currMode]&&this.dispatchers[this.currMode].trigger("unpipe"),this.currMode=t,this.dispatchers[t]&&this.dispatchers[t].emit("pipe"),this.emit("change",{from:i,to:t})}},n.prototype.forMode=function(t){return this.dispatchers[t]||(this.dispatchers[t]=new s),this.dispatchers[t]},n.prototype.emit=function(t,i){if(void 0===this.currMode)return!1;i||(i={});var e=this.dispatchers[this.currMode];return e?e.trigger(t,i):void 0},e.exports=n}),define(function(t,i,e){function n(t){s.call(this),this._mappingFunction=t}var s=t("famous/core/EventHandler");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.subscribe=null,n.prototype.unsubscribe=null,n.prototype.emit=function(t,i){var e=this._mappingFunction.apply(this,arguments);e&&e.emit instanceof Function&&e.emit(t,i)},n.prototype.trigger=n.prototype.emit,e.exports=n}),define(function(t,i,e){function n(t){s.call(this),this._condition=t}var s=t("famous/core/EventHandler");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.emit=function(t,i){return this._condition(t,i)?s.prototype.emit.apply(this,arguments):void 0},n.prototype.trigger=n.prototype.emit,e.exports=n}),define(function(t,i,e){function n(t){return this.values=t||[[1,0,0],[0,1,0],[0,0,1]],this}var s=t("./Vector"),o=new n,r=new s;n.prototype.get=function(){return this.values},n.prototype.set=function(t){this.values=t},n.prototype.vectorMultiply=function(t){var i=this.get(),e=t.x,n=t.y,s=t.z,o=i[0],a=i[1],h=i[2],c=o[0],p=o[1],u=o[2],l=a[0],f=a[1],d=a[2],_=h[0],y=h[1],g=h[2];return r.setXYZ(c*e+p*n+u*s,l*e+f*n+d*s,_*e+y*n+g*s)},n.prototype.multiply=function(t){for(var i=this.get(),e=[[]],n=0;3>n;n++){e[n]=[];for(var s=0;3>s;s++){for(var r=0,a=0;3>a;a++)r+=i[n][a]*t[a][s];e[n][s]=r}}return o.set(e)},n.prototype.transpose=function(){for(var t=[],i=this.get(),e=0;3>e;e++)for(var n=0;3>n;n++)t[e][n]=i[n][e];return o.set(t)},n.prototype.clone=function(){for(var t=this.get(),i=[],e=0;3>e;e++)i[e]=t[e].slice();return new n(i)},e.exports=n}),define(function(t,i,e){function n(t,i,e,n){return 1===arguments.length?this.set(t):(this.w=void 0!==t?t:1,this.x=void 0!==i?i:0,this.y=void 0!==e?e:0,this.z=void 0!==n?n:0),this}var s=t("./Matrix"),o=new n(1,0,0,0);n.prototype.add=function(t){return o.setWXYZ(this.w+t.w,this.x+t.x,this.y+t.y,this.z+t.z)},n.prototype.sub=function(t){return o.setWXYZ(this.w-t.w,this.x-t.x,this.y-t.y,this.z-t.z)},n.prototype.scalarDivide=function(t){return this.scalarMultiply(1/t)},n.prototype.scalarMultiply=function(t){return o.setWXYZ(this.w*t,this.x*t,this.y*t,this.z*t)},n.prototype.multiply=function(t){var i=this.x,e=this.y,n=this.z,s=this.w,r=t.x,a=t.y,h=t.z,c=t.w||0;return o.setWXYZ(s*c-i*r-e*a-n*h,i*c+r*s+a*n-e*h,e*c+a*s+i*h-r*n,n*c+h*s+r*e-i*a)};var r=new n(1,0,0,0);n.prototype.rotateVector=function(t){return r.set(this.conj()),o.set(this.multiply(t).multiply(r))},n.prototype.inverse=function(){return o.set(this.conj().scalarDivide(this.normSquared()))},n.prototype.negate=function(){return this.scalarMultiply(-1)},n.prototype.conj=function(){return o.setWXYZ(this.w,-this.x,-this.y,-this.z)},n.prototype.normalize=function(t){return t=void 0===t?1:t,this.scalarDivide(t*this.norm())},n.prototype.makeFromAngleAndAxis=function(t,i){var e=i.normalize(),n=.5*t,s=-Math.sin(n);return this.x=s*e.x,this.y=s*e.y,this.z=s*e.z,this.w=Math.cos(n),this},n.prototype.setWXYZ=function(t,i,e,n){return o.clear(),this.w=t,this.x=i,this.y=e,this.z=n,this},n.prototype.set=function(t){return t instanceof Array?(this.w=t[0],this.x=t[1],this.y=t[2],this.z=t[3]):(this.w=t.w,this.x=t.x,this.y=t.y,this.z=t.z),this!==o&&o.clear(),this},n.prototype.put=function(t){t.set(o)},n.prototype.clone=function(){return new n(this)},n.prototype.clear=function(){return this.w=1,this.x=0,this.y=0,this.z=0,this},n.prototype.isEqual=function(t){return t.w===this.w&&t.x===this.x&&t.y===this.y&&t.z===this.z},n.prototype.dot=function(t){return this.w*t.w+this.x*t.x+this.y*t.y+this.z*t.z},n.prototype.normSquared=function(){return this.dot(this)},n.prototype.norm=function(){return Math.sqrt(this.normSquared())},n.prototype.isZero=function(){return!(this.x||this.y||this.z)},n.prototype.getTransform=function(){var t=this.normalize(1),i=t.x,e=t.y,n=t.z,s=t.w;return[1-2*e*e-2*n*n,2*i*e-2*n*s,2*i*n+2*e*s,0,2*i*e+2*n*s,1-2*i*i-2*n*n,2*e*n-2*i*s,0,2*i*n-2*e*s,2*e*n+2*i*s,1-2*i*i-2*e*e,0,0,0,0,1]};var a=new s;n.prototype.getMatrix=function(){var t=this.normalize(1),i=t.x,e=t.y,n=t.z,s=t.w;return a.set([[1-2*e*e-2*n*n,2*i*e+2*n*s,2*i*n-2*e*s],[2*i*e-2*n*s,1-2*i*i-2*n*n,2*e*n+2*i*s],[2*i*n+2*e*s,2*e*n-2*i*s,1-2*i*i-2*e*e]])};var h=1e-5;n.prototype.slerp=function(t,i){var e,n,s,r,a;return n=this.dot(t),1-n>h?(e=Math.acos(n),s=Math.sin(e),r=Math.sin((1-i)*e)/s,a=Math.sin(i*e)/s):(r=1-i,a=i),o.set(this.scalarMultiply(r/a).add(t).multiply(a))},e.exports=n}),define(function(t,i,e){function n(t,i){return t+o()*(i-t)}function s(t,i){return t+o()*(i-t+1)>>0}var o=Math.random,r={};r.integer=function(t,i,e){if(t=void 0!==t?t:0,i=void 0!==i?i:1,void 0!==e){for(var n=[],o=0;e>o;o++)n.push(s(t,i));return n}return s(t,i)},r.range=function(t,i,e){if(t=void 0!==t?t:0,i=void 0!==i?i:1,void 0!==e){for(var s=[],o=0;e>o;o++)s.push(n(t,i));return s}return n(t,i)},r.sign=function(t){return t=void 0!==t?t:.5,o()<t?1:-1},r.bool=function(t){return t=void 0!==t?t:.5,o()<t},e.exports=r}),define(function(t,i,e){var n={};n.clamp=function(t,i){return Math.max(Math.min(t,i[1]),i[0])},n.length=function(t){for(var i=0,e=0;e<t.length;e++)i+=t[e]*t[e];return Math.sqrt(i)},e.exports=n}),define(function(t,i,e){function n(t,i,e){return 1===arguments.length?this.set(t):(this.x=t||0,this.y=i||0,this.z=e||0),this}function s(t,i,e){return this.x=t,this.y=i,this.z=e,this}function o(t){return s.call(this,t[0],t[1],t[2]||0)}function r(t){return s.call(this,t.x,t.y,t.z)}function a(t){return s.call(this,t,0,0)}var h=new n(0,0,0);n.prototype.add=function(t){return s.call(h,this.x+t.x,this.y+t.y,this.z+t.z)},n.prototype.sub=function(t){return s.call(h,this.x-t.x,this.y-t.y,this.z-t.z)},n.prototype.mult=function(t){return s.call(h,t*this.x,t*this.y,t*this.z)},n.prototype.div=function(t){return this.mult(1/t)},n.prototype.cross=function(t){var i=this.x,e=this.y,n=this.z,o=t.x,r=t.y,a=t.z;return s.call(h,n*r-e*a,i*a-n*o,e*o-i*r)},n.prototype.equals=function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},n.prototype.rotateX=function(t){var i=this.x,e=this.y,n=this.z,o=Math.cos(t),r=Math.sin(t);return s.call(h,i,e*o-n*r,e*r+n*o)},n.prototype.rotateY=function(t){var i=this.x,e=this.y,n=this.z,o=Math.cos(t),r=Math.sin(t);return s.call(h,n*r+i*o,e,n*o-i*r)},n.prototype.rotateZ=function(t){var i=this.x,e=this.y,n=this.z,o=Math.cos(t),r=Math.sin(t);return s.call(h,i*o-e*r,i*r+e*o,n)},n.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},n.prototype.normSquared=function(){return this.dot(this)},n.prototype.norm=function(){return Math.sqrt(this.normSquared())},n.prototype.normalize=function(t){0===arguments.length&&(t=1);var i=this.norm();return i>1e-7?r.call(h,this.mult(t/i)):s.call(h,t,0,0)},n.prototype.clone=function(){return new n(this)},n.prototype.isZero=function(){return!(this.x||this.y||this.z)},n.prototype.set=function(t){return t instanceof Array?o.call(this,t):t instanceof n?r.call(this,t):"number"==typeof t?a.call(this,t):void 0},n.prototype.setXYZ=function(){return s.apply(this,arguments)},n.prototype.set1D=function(t){return a.call(this,t)},n.prototype.put=function(t){this===h?r.call(t,h):r.call(t,this)},n.prototype.clear=function(){return s.call(this,0,0,0)},n.prototype.cap=function c(c){if(1/0===c)return r.call(h,this);var t=this.norm();return t>c?r.call(h,this.mult(c/t)):r.call(h,this)},n.prototype.project=function(t){return t.mult(this.dot(t))},n.prototype.reflectAcross=function(t){return t.normalize().put(t),r(h,this.sub(this.project(t).mult(2)))},n.prototype.get=function(){return[this.x,this.y,this.z]},n.prototype.get1D=function(){return this.x},e.exports=n}),define(function(t,i,e){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),t&&this.setOptions(t),this._positionState=new p([0,0]),this._differential=[0,0],this._active=!0,this.sync=new f(["mouse","touch"],{scale:this.options.scale}),this.eventOutput=new u,u.setInputHandler(this,this.sync),u.setOutputHandler(this,this.eventOutput),h.call(this)}function s(t){var i=this.options,e=i.projection,n=i.snapX,s=i.snapY,o=e&y.x?t[0]:0,r=e&y.y?t[1]:0;return n>0&&(o-=o%n),s>0&&(r-=r%s),[o,r]}function o(){this._active&&(this._positionState.isActive()&&this._positionState.halt(),this.eventOutput.emit("start",{position:this.getPosition()}))}function r(t){if(this._active){var i=this.options;this._differential=t.position;var e=s.call(this,this._differential);this._differential[0]-=e[0],this._differential[1]-=e[1];var n=this.getPosition();if(n[0]+=e[0],n[1]+=e[1],i.xRange){var o=[i.xRange[0]+.5*i.snapX,i.xRange[1]-.5*i.snapX];n[0]=g(n[0],o)}if(i.yRange){var r=[i.yRange[0]+.5*i.snapY,i.yRange[1]-.5*i.snapY];n[1]=g(n[1],r)}this.eventOutput.emit("update",{position:n})}}function a(){this._active&&this.eventOutput.emit("end",{position:this.getPosition()})}function h(){this.sync.on("start",o.bind(this)),this.sync.on("update",r.bind(this)),this.sync.on("end",a.bind(this))}var c=t("famous/core/Transform"),p=t("famous/transitions/Transitionable"),u=t("famous/core/EventHandler"),l=t("famous/math/Utilities"),f=t("famous/inputs/GenericSync"),d=t("famous/inputs/MouseSync"),_=t("famous/inputs/TouchSync");f.register({mouse:d,touch:_});var y={x:1,y:2};n.DIRECTION_X=y.x,n.DIRECTION_Y=y.y;var g=l.clamp;n.DEFAULT_OPTIONS={projection:y.x|y.y,scale:1,xRange:null,yRange:null,snapX:0,snapY:0,transition:{duration:0}},n.prototype.setOptions=function(t){var i=this.options;if(void 0!==t.projection){var e=t.projection;this.options.projection=0,["x","y"].forEach(function(t){-1!==e.indexOf(t)&&(i.projection|=y[t])})}void 0!==t.scale&&(i.scale=t.scale,this.sync.setOptions({scale:t.scale})),void 0!==t.xRange&&(i.xRange=t.xRange),void 0!==t.yRange&&(i.yRange=t.yRange),void 0!==t.snapX&&(i.snapX=t.snapX),void 0!==t.snapY&&(i.snapY=t.snapY)},n.prototype.getPosition=function(){return this._positionState.get()},n.prototype.setRelativePosition=function(t,i,e){var n=this.getPosition(),s=[n[0]+t[0],n[1]+t[1]];this.setPosition(s,i,e)},n.prototype.setPosition=function(t,i,e){this._positionState.isActive()&&this._positionState.halt(),this._positionState.set(t,i,e)},n.prototype.activate=function(){this._active=!0},n.prototype.deactivate=function(){this._active=!1},n.prototype.toggle=function(){this._active=!this._active},n.prototype.modify=function(t){var i=this.getPosition();return{transform:c.translate(i[0],i[1]),target:t}},e.exports=n}),define(function(t,i,e){function n(t,i){this.options=Object.create(n.DEFAULT_OPTIONS),this._optionsManager=new o(this.options),t&&this.setOptions(t),i||(i=0),this.transitionHelper=new s(i)}var s=t("famous/transitions/Transitionable"),o=t("famous/core/OptionsManager");n.DEFAULT_OPTIONS={cull:!1,transition:!0,pulseInTransition:!0,pulseOutTransition:!0},n.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},n.prototype.show=function(t,i){t=t||this.options.transition,this.set(1,t,i)},n.prototype.hide=function(t,i){t=t||this.options.transition,this.set(0,t,i)},n.prototype.set=function(t,i,e){this.halt(),this.transitionHelper.set(t,i,e)},n.prototype.halt=function(){this.transitionHelper.halt()},n.prototype.isVisible=function(){return this.transitionHelper.get()>0},n.prototype.modify=function(t){var i=this.transitionHelper.get();return this.options.cull&&!i?void 0:{opacity:i,target:t}},e.exports=n}),define(function(t,i,e){function n(){this._chain=[],arguments.length&&this.addModifier.apply(this,arguments)}n.prototype.addModifier=function(){Array.prototype.push.apply(this._chain,arguments)},n.prototype.removeModifier=function(t){var i=this._chain.indexOf(t);0>i||this._chain.splice(i,1)},n.prototype.modify=function(t){for(var i=this._chain,e=t,n=0;n<i.length;n++)e=i[n].modify(e);return e},e.exports=n}),define(function(t,i,e){function n(t){this._transformState=new a(o.identity),this._opacityState=new r(1),this._originState=new r([0,0]),this._alignState=new r([0,0]),this._sizeState=new r([0,0]),this._modifier=new s({transform:this._transformState,opacity:this._opacityState,origin:null,align:null,size:null}),this._hasOrigin=!1,this._hasAlign=!1,this._hasSize=!1,t&&(t.transform&&this.setTransform(t.transform),void 0!==t.opacity&&this.setOpacity(t.opacity),t.origin&&this.setOrigin(t.origin),t.align&&this.setAlign(t.align),t.size&&this.setSize(t.size))}var s=t("famous/core/Modifier"),o=t("famous/core/Transform"),r=t("famous/transitions/Transitionable"),a=t("famous/transitions/TransitionableTransform");n.prototype.setTransform=function(t,i,e){return this._transformState.set(t,i,e),this},n.prototype.setOpacity=function(t,i,e){return this._opacityState.set(t,i,e),this},n.prototype.setOrigin=function(t,i,e){return null===t?(this._hasOrigin&&(this._modifier.originFrom(null),this._hasOrigin=!1),this):(this._hasOrigin||(this._hasOrigin=!0,this._modifier.originFrom(this._originState)),this._originState.set(t,i,e),this)},n.prototype.setAlign=function(t,i,e){return null===t?(this._hasAlign&&(this._modifier.alignFrom(null),this._hasAlign=!1),this):(this._hasAlign||(this._hasAlign=!0,this._modifier.alignFrom(this._alignState)),this._alignState.set(t,i,e),this)},n.prototype.setSize=function(t,i,e){return null===t?(this._hasSize&&(this._modifier.sizeFrom(null),this._hasSize=!1),this):(this._hasSize||(this._hasSize=!0,this._modifier.sizeFrom(this._sizeState)),this._sizeState.set(t,i,e),this)},n.prototype.halt=function(){this._transformState.halt(),this._opacityState.halt(),this._originState.halt(),this._alignState.halt(),this._sizeState.halt()},n.prototype.getTransform=function(){return this._transformState.get()},n.prototype.getFinalTransform=function(){return this._transformState.getFinal()},n.prototype.getOpacity=function(){return this._opacityState.get()},n.prototype.getOrigin=function(){return this._hasOrigin?this._originState.get():null},n.prototype.getAlign=function(){return this._hasAlign?this._alignState.get():null},n.prototype.getSize=function(){return this._hasSize?this._sizeState.get():null},n.prototype.modify=function(t){return this._modifier.modify(t)},e.exports=n}),define(function(t,i,e){function n(t){t&&t.canvasSize&&(this._canvasSize=t.canvasSize),s.apply(this,arguments),this._canvasSize||(this._canvasSize=this.getSize()),this._backBuffer=document.createElement("canvas"),this._canvasSize&&(this._backBuffer.width=this._canvasSize[0],this._backBuffer.height=this._canvasSize[1]),this._contextId=void 0}var s=t("famous/core/Surface");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.elementType="canvas",n.prototype.elementClass="famous-surface",n.prototype.setContent=function(){},n.prototype.deploy=function(t){this._canvasSize&&(t.width=this._canvasSize[0],t.height=this._canvasSize[1]),"2d"===this._contextId&&(t.getContext(this._contextId).drawImage(this._backBuffer,0,0),this._backBuffer.width=0,this._backBuffer.height=0)},n.prototype.recall=function(t){this.getSize();this._backBuffer.width=t.width,this._backBuffer.height=t.height,"2d"===this._contextId&&(this._backBuffer.getContext(this._contextId).drawImage(t,0,0),t.width=0,t.height=0)},n.prototype.getContext=function(t){return this._contextId=t,this._currTarget?this._currTarget.getContext(t):this._backBuffer.getContext(t)},n.prototype.setSize=function(t,i){s.prototype.setSize.apply(this,arguments),i&&(this._canvasSize=[i[0],i[1]]),this._currTarget&&(this._currTarget.width=this._canvasSize[0],this._currTarget.height=this._canvasSize[1])},e.exports=n}),define(function(t,i,e){function n(t){s.call(this,t),this._container=document.createElement("div"),this._container.classList.add("famous-group"),this._container.classList.add("famous-container-group"),this._shouldRecalculateSize=!1,this.context=new o(this._container),this.setContent(this._container)}var s=t("famous/core/Surface"),o=t("famous/core/Context");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.elementType="div",n.prototype.elementClass="famous-surface",n.prototype.add=function(){return this.context.add.apply(this.context,arguments)},n.prototype.render=function(){return this._sizeDirty&&(this._shouldRecalculateSize=!0),s.prototype.render.apply(this,arguments)},n.prototype.deploy=function(){return this._shouldRecalculateSize=!0,s.prototype.deploy.apply(this,arguments)},n.prototype.commit=function(){var t=this._size?[this._size[0],this._size[1]]:null,i=s.prototype.commit.apply(this,arguments);return(this._shouldRecalculateSize||t&&(this._size[0]!==t[0]||this._size[1]!==t[1]))&&(this.context.setSize(),this._shouldRecalculateSize=!1),this.context.update(),i},e.exports=n}),define(function(t,i,e){function n(t){t&&(this._method=t.method||""),s.apply(this,arguments)}var s=t("./ContainerSurface");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.elementType="form",n.prototype.deploy=function(t){return this._method&&(t.method=this._method),s.prototype.deploy.apply(this,arguments)},e.exports=n}),define(function(t,i,e){function n(){this._imageUrl=void 0,s.apply(this,arguments)}var s=t("famous/core/Surface");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.elementType="img",n.prototype.elementClass="famous-surface",n.prototype.setContent=function(t){this._imageUrl=t,this._contentDirty=!0},n.prototype.deploy=function(t){t.src=this._imageUrl||""},n.prototype.recall=function(t){t.src=""},e.exports=n}),define(function(t,i,e){function n(t){this._placeholder=t.placeholder||"",this._value=t.value||"",this._type=t.type||"text",this._name=t.name||"",s.apply(this,arguments),this.on("click",this.focus.bind(this)),window.addEventListener("click",function(t){t.target!==this._currTarget&&this.blur()}.bind(this))}var s=t("famous/core/Surface");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.elementType="input",n.prototype.elementClass="famous-surface",n.prototype.setPlaceholder=function(t){return this._placeholder=t,this._contentDirty=!0,this},n.prototype.focus=function(){return this._currTarget&&this._currTarget.focus(),this},n.prototype.blur=function(){return this._currTarget&&this._currTarget.blur(),this},n.prototype.setValue=function(t){return this._value=t,this._contentDirty=!0,this},n.prototype.setType=function(t){return this._type=t,this._contentDirty=!0,this},n.prototype.getValue=function(){return this._currTarget?this._currTarget.value:this._value},n.prototype.setName=function(t){return this._name=t,this._contentDirty=!0,this},n.prototype.getName=function(){return this._name},n.prototype.deploy=function(t){""!==this._placeholder&&(t.placeholder=this._placeholder),t.value=this._value,t.type=this._type,t.name=this._name},e.exports=n}),define(function(t,i,e){function n(t){s.apply(this,arguments),this._type="submit",t&&t.onClick&&this.setOnClick(t.onClick)}var s=t("./InputSurface");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.setOnClick=function(t){this.onClick=t},n.prototype.deploy=function(t){this.onclick&&(t.onClick=this.onClick),s.prototype.deploy.apply(this,arguments)},e.exports=n}),define(function(t,i,e){function n(t){this._placeholder=t.placeholder||"",this._value=t.value||"",this._name=t.name||"",this._wrap=t.wrap||"",this._cols=t.cols||"",this._rows=t.rows||"",s.apply(this,arguments),this.on("click",this.focus.bind(this))}var s=t("famous/core/Surface");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.elementType="textarea",n.prototype.elementClass="famous-surface",n.prototype.setPlaceholder=function(t){return this._placeholder=t,this._contentDirty=!0,this},n.prototype.focus=function(){return this._currTarget&&this._currTarget.focus(),this},n.prototype.blur=function(){return this._currTarget&&this._currTarget.blur(),this},n.prototype.setValue=function(t){return this._value=t,this._contentDirty=!0,this},n.prototype.getValue=function(){return this._currTarget?this._currTarget.value:this._value},n.prototype.setName=function(t){return this._name=t,this._contentDirty=!0,this},n.prototype.getName=function(){return this._name},n.prototype.setWrap=function(t){return this._wrap=t,this._contentDirty=!0,this},n.prototype.setColumns=function(t){return this._cols=t,this._contentDirty=!0,this},n.prototype.setRows=function(t){return this._rows=t,this._contentDirty=!0,this},n.prototype.deploy=function(t){""!==this._placeholder&&(t.placeholder=this._placeholder),""!==this._value&&(t.value=this._value),""!==this._name&&(t.name=this._name),""!==this._wrap&&(t.wrap=this._wrap),""!==this._cols&&(t.cols=this._cols),""!==this._rows&&(t.rows=this._rows)},e.exports=n}),define(function(t,i,e){function n(t){this._videoUrl=void 0,this.options=Object.create(n.DEFAULT_OPTIONS),t&&this.setOptions(t),s.apply(this,arguments)}var s=t("famous/core/Surface");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={autoplay:!1},n.prototype.elementType="video",n.prototype.elementClass="famous-surface",n.prototype.setOptions=function(t){for(var i in n.DEFAULT_OPTIONS)void 0!==t[i]&&(this.options[i]=t[i])},n.prototype.setContent=function(t){this._videoUrl=t,this._contentDirty=!0},n.prototype.deploy=function(t){t.src=this._videoUrl,t.autoplay=this.options.autoplay},n.prototype.recall=function(t){t.src=""},e.exports=n}),define(function(t,i,e){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),t&&this.setOptions(t),this._particles=[],this._bodies=[],this._agents={},this._forces=[],this._constraints=[],this._buffer=0,this._prevTime=w(),this._isSleeping=!1,this._eventHandler=null,this._currAgentId=0,this._hasBodies=!1}function s(t){return t.applyForce?this._forces:t.applyConstraint?this._constraints:void 0}function o(t,i,e){return void 0===i&&(i=this.getParticlesAndBodies()),i instanceof Array||(i=[i]),this._agents[this._currAgentId]={agent:t,targets:i,source:e},s.call(this,t).push(this._currAgentId),this._currAgentId++}function r(t){return this._agents[t]}function a(t){var i=r.call(this,this._forces[t]);i.agent.applyForce(i.targets,i.source)}function h(){for(var t=this._forces.length-1;t>-1;t--)a.call(this,t)}function c(t,i){var e=this._agents[this._constraints[t]];return e.agent.applyConstraint(e.targets,e.source,i)}function p(t){for(var i=0;i<this.options.constraintSteps;){for(var e=this._constraints.length-1;e>-1;e--)c.call(this,e,t);i++}}function u(t,i){t.integrateVelocity(i)}function l(t,i){t.integrateAngularMomentum(i),t.updateAngularVelocity()}function f(t,i){t.integrateOrientation(i)}function d(t,i){t.integratePosition(i),t.emit("update",t)}function _(t){h.call(this,t),this.forEach(u,t),this.forEachBody(l,t),p.call(this,t),this.forEachBody(f,t),this.forEach(d,t)}function y(){var t=0,i=0;return this.forEach(function(e){i=e.getEnergy(),t+=i,i<e.sleepTolerance&&e.sleep()}),t}function g(){for(var t=0,i=this._forces.length-1;i>-1;i--)t+=this._forces[i].getEnergy()||0;return t}function v(){for(var t=0,i=this._constraints.length-1;i>-1;i--)t+=this._constraints[i].getEnergy()||0;return t}var m=t("famous/core/EventHandler"),O=17,T=1e3/120,S=17;n.DEFAULT_OPTIONS={constraintSteps:1,sleepTolerance:1e-7};var w=function(){return Date.now}();n.prototype.setOptions=function(t){for(var i in t)this.options[i]&&(this.options[i]=t[i])},n.prototype.addBody=function(t){return t._engine=this,t.isBody?(this._bodies.push(t),this._hasBodies=!0):this._particles.push(t),t},n.prototype.removeBody=function(t){var i=t.isBody?this._bodies:this._particles,e=i.indexOf(t);if(e>-1){for(var n=0;n<Object.keys(this._agents).length;n++)this.detachFrom(n,t);i.splice(e,1)}0===this.getBodies().length&&(this._hasBodies=!1)},n.prototype.attach=function(t,i,e){if(t instanceof Array){for(var n=[],s=0;s<t.length;s++)n[s]=o.call(this,t[s],i,e);return n}return o.call(this,t,i,e)},n.prototype.attachTo=function(t,i){r.call(this,t).targets.push(i)},n.prototype.detach=function(t){var i=this.getAgent(t),e=s.call(this,i),n=e.indexOf(t);e.splice(n,1),delete this._agents[t]},n.prototype.detachFrom=function(t,i){var e=r.call(this,t);if(e.source===i)this.detach(t);else{var n=e.targets,s=n.indexOf(i);s>-1&&n.splice(s,1)}},n.prototype.detachAll=function(){this._agents={},this._forces=[],this._constraints=[],this._currAgentId=0},n.prototype.getAgent=function(t){return r.call(this,t).agent},n.prototype.getParticles=function(){return this._particles},n.prototype.getBodies=function(){return this._bodies},n.prototype.getParticlesAndBodies=function(){return this.getParticles().concat(this.getBodies())},n.prototype.forEachParticle=function(t,i){for(var e=this.getParticles(),n=0,s=e.length;s>n;n++)t.call(this,e[n],i)},n.prototype.forEachBody=function(t,i){if(this._hasBodies)for(var e=this.getBodies(),n=0,s=e.length;s>n;n++)t.call(this,e[n],i)},n.prototype.forEach=function(t,i){this.forEachParticle(t,i),this.forEachBody(t,i)},n.prototype.getEnergy=function(){return y.call(this)+g.call(this)+v.call(this)},n.prototype.step=function(){var t=w(),i=t-this._prevTime;this._prevTime=t,T>i||(i>S&&(i=S),_.call(this,O))},n.prototype.isSleeping=function(){return this._isSleeping},n.prototype.sleep=function(){this.emit("end",this),this._isSleeping=!0},n.prototype.wake=function(){this._prevTime=w(),this.emit("start",this),this._isSleeping=!1},n.prototype.emit=function(t,i){null!==this._eventHandler&&this._eventHandler.emit(t,i)},n.prototype.on=function(t,i){null===this._eventHandler&&(this._eventHandler=new m),this._eventHandler.on(t,i)},e.exports=n}),define(function(t,i,e){function n(t,i){void 0===i&&(i="update"),this._state=t&&t.get&&t.set?t:new r(t||0),this._eventInput=new o,o.setInputHandler(this,this._eventInput),this._eventInput.on(i,s.bind(this))}function s(t){var i=t.delta,e=this.get();if(i.constructor===e.constructor){var n=i instanceof Array?[e[0]+i[0],e[1]+i[1]]:e+i;this.set(n)}}var o=t("famous/core/EventHandler"),r=t("famous/transitions/Transitionable");n.prototype.get=function(){return this._state.get()},n.prototype.set=function(t){this._state.set(t)},e.exports=n}),define(function(){function t(t){window.addEventListener(t,function(t){return t.stopPropagation(),!1},!0)}var i="ontouchstart"in window;i&&(t("mousedown"),t("mousemove"),t("mouseup"),t("mouseleave"))}),define(function(){if(window.CustomEvent){var t=300,i=500,e={},n={},s=Date.now;window.addEventListener("touchstart",function(t){for(var i=s(),n=0;n<t.changedTouches.length;n++){var o=t.changedTouches[n];e[o.identifier]=i}}),window.addEventListener("touchmove",function(t){for(var i=0;i<t.changedTouches.length;i++){var n=t.changedTouches[i];delete e[n.identifier]}}),window.addEventListener("touchend",function(i){for(var o=s(),r=0;r<i.changedTouches.length;r++){var a=i.changedTouches[r],h=e[a.identifier];if(h&&t>o-h){var c=new window.CustomEvent("click",{bubbles:!0,detail:a});n[o]=i,i.target.dispatchEvent(c)}delete e[a.identifier]}}),window.addEventListener("click",function(t){var e=s();for(var o in n){var r=n[o];i>e-o?t instanceof window.MouseEvent&&t.target===r.target&&t.stopPropagation():delete n[o]}},!0)}}),define(function(t,i,e){function n(t,i){this._eventInput=new o,this._eventOutput=new o,o.setInputHandler(this,this._eventInput),o.setOutputHandler(this,this._eventOutput),this._syncs={},t&&this.addSync(t),i&&this.setOptions(i)
}function s(t,i){r[t]&&(this._syncs[t]=new r[t](i),this.pipeSync(t))}var o=t("famous/core/EventHandler");n.DIRECTION_X=0,n.DIRECTION_Y=1,n.DIRECTION_Z=2;var r={};n.register=function(t){for(var i in t){if(r[i]){if(r[i]===t[i])return;throw new Error("this key is registered to a different sync class")}r[i]=t[i]}},n.prototype.setOptions=function(t){for(var i in this._syncs)this._syncs[i].setOptions(t)},n.prototype.pipeSync=function(t){var i=this._syncs[t];this._eventInput.pipe(i),i.pipe(this._eventOutput)},n.prototype.unpipeSync=function(t){var i=this._syncs[t];this._eventInput.unpipe(i),i.unpipe(this._eventOutput)},n.prototype.addSync=function(t){if(t instanceof Array)for(var i=0;i<t.length;i++)s.call(this,t[i]);else if(t instanceof Object)for(var e in t)s.call(this,e,t[e])},e.exports=n}),define(function(t,i,e){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),t&&this.setOptions(t),this._eventInput=new h,this._eventOutput=new h,h.setInputHandler(this,this._eventInput),h.setOutputHandler(this,this._eventOutput),this._eventInput.on("mousedown",s.bind(this)),this._eventInput.on("mousemove",o.bind(this)),this._eventInput.on("mouseup",r.bind(this)),this.options.propogate?this._eventInput.on("mouseleave",a.bind(this)):this._eventInput.on("mouseleave",r.bind(this)),this._payload={delta:null,position:null,velocity:null,clientX:0,clientY:0,offsetX:0,offsetY:0},this._position=null,this._prevCoord=void 0,this._prevTime=void 0,this._down=!1,this._moved=!1}function s(t){var i,e;t.preventDefault();var n=t.clientX,s=t.clientY;this._prevCoord=[n,s],this._prevTime=p(),this._down=!0,this._move=!1,void 0!==this.options.direction?(this._position=0,i=0,e=0):(this._position=[0,0],i=[0,0],e=[0,0]);var o=this._payload;o.delta=i,o.position=this._position,o.velocity=e,o.clientX=n,o.clientY=s,o.offsetX=t.offsetX,o.offsetY=t.offsetY,this._eventOutput.emit("start",o)}function o(t){if(this._prevCoord){var i=this._prevCoord,e=this._prevTime,s=t.clientX,o=t.clientY,r=p(),a=s-i[0],h=o-i[1];this.options.rails&&(Math.abs(a)>Math.abs(h)?h=0:a=0);var u,l,f=Math.max(r-e,c),d=a/f,_=h/f,y=this.options.scale;this.options.direction===n.DIRECTION_X?(l=y*a,u=y*d,this._position+=l):this.options.direction===n.DIRECTION_Y?(l=y*h,u=y*_,this._position+=l):(l=[y*a,y*h],u=[y*d,y*_],this._position[0]+=l[0],this._position[1]+=l[1]);var g=this._payload;g.delta=l,g.position=this._position,g.velocity=u,g.clientX=s,g.clientY=o,g.offsetX=t.offsetX,g.offsetY=t.offsetY,this._eventOutput.emit("update",g),this._prevCoord=[s,o],this._prevTime=r,this._move=!0}}function r(){this._down&&(this._eventOutput.emit("end",this._payload),this._prevCoord=void 0,this._prevTime=void 0,this._down=!1,this._move=!1)}function a(t){if(this._down&&this._move){var i=o.bind(this),e=function(t){r.call(this,t),document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",e)}.bind(this,t);document.addEventListener("mousemove",i),document.addEventListener("mouseup",e)}}var h=t("famous/core/EventHandler");n.DEFAULT_OPTIONS={direction:void 0,rails:!1,scale:1,propogate:!0},n.DIRECTION_X=0,n.DIRECTION_Y=1;var c=8,p=Date.now;n.prototype.getOptions=function(){return this.options},n.prototype.setOptions=function(t){void 0!==t.direction&&(this.options.direction=t.direction),void 0!==t.rails&&(this.options.rails=t.rails),void 0!==t.scale&&(this.options.scale=t.scale),void 0!==t.propogate&&(this.options.propogate=t.propogate)},e.exports=n}),define(function(t,i,e){function n(t){s.call(this),this.options=Object.create(n.DEFAULT_OPTIONS),t&&this.setOptions(t),this._displacement=0,this._previousDistance=0}var s=t("./TwoFingerSync");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={scale:1},n.prototype._startUpdate=function(t){this._previousDistance=s.calculateDistance(this.posA,this.posB),this._displacement=0,this._eventOutput.emit("start",{count:t.touches.length,touches:[this.touchAId,this.touchBId],distance:this._dist,center:s.calculateCenter(this.posA,this.posB)})},n.prototype._moveUpdate=function(t){var i=s.calculateDistance(this.posA,this.posB),e=s.calculateCenter(this.posA,this.posB),n=this.options.scale,o=n*(i-this._previousDistance),r=o/t;this._previousDistance=i,this._displacement+=o,this._eventOutput.emit("update",{delta:o,velocity:r,distance:i,displacement:this._displacement,center:e,touches:[this.touchAId,this.touchBId]})},n.prototype.getOptions=function(){return this.options},n.prototype.setOptions=function(t){void 0!==t.scale&&(this.options.scale=t.scale)},e.exports=n}),define(function(t,i,e){function n(t){s.call(this),this.options=Object.create(n.DEFAULT_OPTIONS),t&&this.setOptions(t),this._angle=0,this._previousAngle=0}var s=t("./TwoFingerSync");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={scale:1},n.prototype._startUpdate=function(t){this._angle=0,this._previousAngle=s.calculateAngle(this.posA,this.posB);var i=s.calculateCenter(this.posA,this.posB);this._eventOutput.emit("start",{count:t.touches.length,angle:this._angle,center:i,touches:[this.touchAId,this.touchBId]})},n.prototype._moveUpdate=function(t){var i=this.options.scale,e=s.calculateAngle(this.posA,this.posB),n=s.calculateCenter(this.posA,this.posB),o=i*(e-this._previousAngle),r=o/t;this._angle+=o,this._eventOutput.emit("update",{delta:o,velocity:r,angle:this._angle,center:n,touches:[this.touchAId,this.touchBId]}),this._previousAngle=e},n.prototype.getOptions=function(){return this.options},n.prototype.setOptions=function(t){void 0!==t.scale&&(this.options.scale=t.scale)},e.exports=n}),define(function(t,i,e){function n(t){o.call(this),this.options=Object.create(n.DEFAULT_OPTIONS),t&&this.setOptions(t),this._scaleFactor=1,this._startDist=0,this._eventInput.on("pipe",s.bind(this))}function s(){this.touchAId=void 0,this.touchBId=void 0}var o=t("./TwoFingerSync");n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={scale:1},n.prototype._startUpdate=function(t){this._scaleFactor=1,this._startDist=o.calculateDistance(this.posA,this.posB),this._eventOutput.emit("start",{count:t.touches.length,touches:[this.touchAId,this.touchBId],distance:this._startDist,center:o.calculateCenter(this.posA,this.posB)})},n.prototype._moveUpdate=function(t){var i=this.options.scale,e=o.calculateDistance(this.posA,this.posB),n=o.calculateCenter(this.posA,this.posB),s=(e-this._startDist)/this._startDist,r=Math.max(1+i*s,0),a=(r-this._scaleFactor)/t;this._eventOutput.emit("update",{delta:s,scale:r,velocity:a,distance:e,center:n,touches:[this.touchAId,this.touchBId]}),this._scaleFactor=r},n.prototype.getOptions=function(){return this.options},n.prototype.setOptions=function(t){void 0!==t.scale&&(this.options.scale=t.scale)},e.exports=n}),define(function(t,i,e){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),t&&this.setOptions(t),this._payload={delta:null,position:null,velocity:null,slip:!0},this._eventInput=new r,this._eventOutput=new r,r.setInputHandler(this,this._eventInput),r.setOutputHandler(this,this._eventOutput),this._position=void 0===this.options.direction?[0,0]:0,this._prevTime=void 0,this._prevVel=void 0,this._eventInput.on("mousewheel",o.bind(this)),this._eventInput.on("wheel",o.bind(this)),this._inProgress=!1,this._loopBound=!1}function s(){if(this._inProgress&&c()-this._prevTime>this.options.stallTime){this._inProgress=!1;var t=Math.abs(this._prevVel)>=this.options.minimumEndSpeed?this._prevVel:0,i=this._payload;i.position=this._position,i.velocity=t,i.slip=!0,this._eventOutput.emit("end",i)}}function o(t){t.preventDefault(),this._inProgress||(this._inProgress=!0,this._position=void 0===this.options.direction?[0,0]:0,y=this._payload,y.slip=!0,y.position=this._position,y.clientX=t.clientX,y.clientY=t.clientY,y.offsetX=t.offsetX,y.offsetY=t.offsetY,this._eventOutput.emit("start",y),this._loopBound||(a.on("prerender",s.bind(this)),this._loopBound=!0));var i=c(),e=this._prevTime||i,o=void 0!==t.wheelDeltaX?t.wheelDeltaX:-t.deltaX,r=void 0!==t.wheelDeltaY?t.wheelDeltaY:-t.deltaY;1===t.deltaMode&&(o*=this.options.lineHeight,r*=this.options.lineHeight),this.options.rails&&(Math.abs(o)>Math.abs(r)?r=0:o=0);var p,u,l=Math.max(i-e,h),f=o/l,d=r/l,_=this.options.scale;this.options.direction===n.DIRECTION_X?(u=_*o,p=_*f,this._position+=u):this.options.direction===n.DIRECTION_Y?(u=_*r,p=_*d,this._position+=u):(u=[_*o,_*r],p=[_*f,_*d],this._position[0]+=u[0],this._position[1]+=u[1]);var y=this._payload;y.delta=u,y.velocity=p,y.position=this._position,y.slip=!0,this._eventOutput.emit("update",y),this._prevTime=i,this._prevVel=p}var r=t("famous/core/EventHandler"),a=t("famous/core/Engine");n.DEFAULT_OPTIONS={direction:void 0,minimumEndSpeed:1/0,rails:!1,scale:1,stallTime:50,lineHeight:40},n.DIRECTION_X=0,n.DIRECTION_Y=1;var h=8,c=Date.now;n.prototype.getOptions=function(){return this.options},n.prototype.setOptions=function(t){void 0!==t.direction&&(this.options.direction=t.direction),void 0!==t.minimumEndSpeed&&(this.options.minimumEndSpeed=t.minimumEndSpeed),void 0!==t.rails&&(this.options.rails=t.rails),void 0!==t.scale&&(this.options.scale=t.scale),void 0!==t.stallTime&&(this.options.stallTime=t.stallTime)},e.exports=n}),define(function(t,i,e){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),t&&this.setOptions(t),this._eventOutput=new h,this._touchTracker=new a,h.setOutputHandler(this,this._eventOutput),h.setInputHandler(this,this._touchTracker),this._touchTracker.on("trackstart",s.bind(this)),this._touchTracker.on("trackmove",o.bind(this)),this._touchTracker.on("trackend",r.bind(this)),this._payload={delta:null,position:null,velocity:null,clientX:void 0,clientY:void 0,count:0,touch:void 0},this._position=null}function s(t){var i,e;void 0!==this.options.direction?(this._position=0,i=0,e=0):(this._position=[0,0],i=[0,0],e=[0,0]);var n=this._payload;n.delta=e,n.position=this._position,n.velocity=i,n.clientX=t.x,n.clientY=t.y,n.count=t.count,n.touch=t.identifier,this._eventOutput.emit("start",n)}function o(t){var i=t.history,e=i[i.length-1],s=i[i.length-2],o=s.timestamp,r=e.timestamp,a=e.x-s.x,h=e.y-s.y;this.options.rails&&(Math.abs(a)>Math.abs(h)?h=0:a=0);var p,u,l=Math.max(r-o,c),f=a/l,d=h/l,_=this.options.scale;this.options.direction===n.DIRECTION_X?(u=_*a,p=_*f,this._position+=u):this.options.direction===n.DIRECTION_Y?(u=_*h,p=_*d,this._position+=u):(u=[_*a,_*h],p=[_*f,_*d],this._position[0]+=u[0],this._position[1]+=u[1]);var y=this._payload;y.delta=u,y.velocity=p,y.position=this._position,y.clientX=t.x,y.clientY=t.y,y.count=t.count,y.touch=t.identifier,this._eventOutput.emit("update",y)}function r(t){this._payload.count=t.count,this._eventOutput.emit("end",this._payload)}var a=t("./TouchTracker"),h=t("famous/core/EventHandler");n.DEFAULT_OPTIONS={direction:void 0,rails:!1,scale:1},n.DIRECTION_X=0,n.DIRECTION_Y=1;var c=8;n.prototype.setOptions=function(t){void 0!==t.direction&&(this.options.direction=t.direction),void 0!==t.rails&&(this.options.rails=t.rails),void 0!==t.scale&&(this.options.scale=t.scale)},n.prototype.getOptions=function(){return this.options},e.exports=n}),define(function(t,i,e){function n(t,i,e){return{x:t.clientX,y:t.clientY,identifier:t.identifier,origin:i.origin,timestamp:p(),count:i.touches.length,history:e}}function s(t){for(var i=0;i<t.changedTouches.length;i++){var e=t.changedTouches[i],s=n(e,t,null);this.eventOutput.emit("trackstart",s),this.selective||this.touchHistory[e.identifier]||this.track(s)}}function o(t){for(var i=0;i<t.changedTouches.length;i++){var e=t.changedTouches[i],s=this.touchHistory[e.identifier];if(s){var o=n(e,t,s);this.touchHistory[e.identifier].push(o),this.eventOutput.emit("trackmove",o)}}}function r(t){for(var i=0;i<t.changedTouches.length;i++){var e=t.changedTouches[i],s=this.touchHistory[e.identifier];if(s){var o=n(e,t,s);this.eventOutput.emit("trackend",o),delete this.touchHistory[e.identifier]}}}function a(){for(var t in this.touchHistory){var i=this.touchHistory[t];this.eventOutput.emit("trackend",{touch:i[i.length-1].touch,timestamp:Date.now(),count:0,history:i}),delete this.touchHistory[t]}}function h(t){this.selective=t,this.touchHistory={},this.eventInput=new c,this.eventOutput=new c,c.setInputHandler(this,this.eventInput),c.setOutputHandler(this,this.eventOutput),this.eventInput.on("touchstart",s.bind(this)),this.eventInput.on("touchmove",o.bind(this)),this.eventInput.on("touchend",r.bind(this)),this.eventInput.on("touchcancel",r.bind(this)),this.eventInput.on("unpipe",a.bind(this))}var c=t("famous/core/EventHandler"),p=Date.now;h.prototype.track=function(t){this.touchHistory[t.identifier]=[t]},e.exports=h}),define(function(t,i,e){function n(){this._eventInput=new s,this._eventOutput=new s,s.setInputHandler(this,this._eventInput),s.setOutputHandler(this,this._eventOutput),this.touchAEnabled=!1,this.touchAId=0,this.posA=null,this.timestampA=0,this.touchBEnabled=!1,this.touchBId=0,this.posB=null,this.timestampB=0,this._eventInput.on("touchstart",this.handleStart.bind(this)),this._eventInput.on("touchmove",this.handleMove.bind(this)),this._eventInput.on("touchend",this.handleEnd.bind(this)),this._eventInput.on("touchcancel",this.handleEnd.bind(this))}var s=t("famous/core/EventHandler");n.calculateAngle=function(t,i){var e=i[0]-t[0],n=i[1]-t[1];return Math.atan2(n,e)},n.calculateDistance=function(t,i){var e=i[0]-t[0],n=i[1]-t[1];return Math.sqrt(e*e+n*n)},n.calculateCenter=function(t,i){return[(t[0]+i[0])/2,(t[1]+i[1])/2]};var o=Date.now;n.prototype.handleStart=function(t){for(var i=0;i<t.changedTouches.length;i++){var e=t.changedTouches[i];this.touchAEnabled?this.touchBEnabled||(this.touchBId=e.identifier,this.touchBEnabled=!0,this.posB=[e.pageX,e.pageY],this.timestampB=o(),this._startUpdate(t)):(this.touchAId=e.identifier,this.touchAEnabled=!0,this.posA=[e.pageX,e.pageY],this.timestampA=o())}},n.prototype.handleMove=function(t){if(this.touchAEnabled&&this.touchBEnabled){for(var i,e=this.timestampA,n=this.timestampB,s=0;s<t.changedTouches.length;s++){var r=t.changedTouches[s];r.identifier===this.touchAId?(this.posA=[r.pageX,r.pageY],this.timestampA=o(),i=this.timestampA-e):r.identifier===this.touchBId&&(this.posB=[r.pageX,r.pageY],this.timestampB=o(),i=this.timestampB-n)}i&&this._moveUpdate(i)}},n.prototype.handleEnd=function(t){for(var i=0;i<t.changedTouches.length;i++){var e=t.changedTouches[i];(e.identifier===this.touchAId||e.identifier===this.touchBId)&&(this.touchAEnabled&&this.touchBEnabled&&this._eventOutput.emit("end",{touches:[this.touchAId,this.touchBId],angle:this._angle}),this.touchAEnabled=!1,this.touchAId=0,this.touchBEnabled=!1,this.touchBId=0)}},e.exports=n}),define(function(t,i,e){var n={0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:97,b:98,c:99,d:100,e:101,f:102,g:103,h:104,i:105,j:106,k:107,l:108,m:109,n:110,o:111,p:112,q:113,r:114,s:115,t:116,u:117,v:118,w:119,x:120,y:121,z:122,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,ENTER:13,LEFT_ARROW:37,RIGHT_ARROW:39,UP_ARROW:38,DOWN_ARROW:40,SPACE:32,SHIFT:16,TAB:9};e.exports=n}),define(function(t,i,e){function n(t){return p.on(u,t),t}function s(t,i){var e=l(),s=function(){var n=l();n-e>=i&&(t.apply(this,arguments),p.removeListener(u,s))};return n(s)}function o(t,i){var e=l(),s=function(){var n=l();n-e>=i&&(t.apply(this,arguments),e=l())};return n(s)}function r(t,i){if(void 0===i)return void 0;var e=function(){i--,0>=i&&(t.apply(this,arguments),h(e))};return n(e)}function a(t,i){i=i||1;var e=i,s=function(){i--,0>=i&&(t.apply(this,arguments),i=e)};return n(s)}function h(t){p.removeListener(u,t)}function c(t,i){var e,n,o,r,a;return function(){n=this,a=arguments,o=l();var c=function(){var h=l-o;i>h?e=s(c,i-h):(e=null,r=t.apply(n,a))};return h(e),e=s(c,i),r}}var p=t("famous/core/Engine"),u="prerender",l=window.performance?function(){return window.performance.now()}:function(){return Date.now()};e.exports={setTimeout:s,setInterval:o,debounce:c,after:r,every:a,clear:h}}),define(function(t,i,e){var n={};n.Direction={X:0,Y:1,Z:2},n.after=function(t,i){var e=t;return function(){e--,0===e&&i.apply(this,arguments)}},n.loadURL=function(t,i){var e=new XMLHttpRequest;e.onreadystatechange=function(){4===this.readyState&&i&&i(this.responseText)},e.open("GET",t),e.send()},n.createDocumentFragmentFromHTML=function(t){var i=document.createElement("div");i.innerHTML=t;for(var e=document.createDocumentFragment();i.hasChildNodes();)e.appendChild(i.firstChild);return e},e.exports=n}),define(function(t,i,e){function n(t){this._map=t||null,this._cachedOutput=null,this._cachedInput=Number.NaN}n.create=function(t){var i=new n(t);return i.get.bind(i)},n.prototype.get=function(t){return t!==this._cachedInput&&(this._cachedInput=t,this._cachedOutput=this._map(t)),this._cachedOutput},e.exports=n}),define(function(t,i,e){var n={inQuad:function(t){return t*t},outQuad:function(t){return-(t-=1)*t+1},inOutQuad:function(t){return(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1)},inCubic:function(t){return t*t*t},outCubic:function(t){return--t*t*t+1},inOutCubic:function(t){return(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},inQuart:function(t){return t*t*t*t},outQuart:function(t){return-(--t*t*t*t-1)},inOutQuart:function(t){return(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},inQuint:function(t){return t*t*t*t*t},outQuint:function(t){return--t*t*t*t*t+1},inOutQuint:function(t){return(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},inSine:function(t){return-1*Math.cos(t*(Math.PI/2))+1},outSine:function(t){return Math.sin(t*(Math.PI/2))},inOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},inExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},outExpo:function(t){return 1===t?1:-Math.pow(2,-10*t)+1},inOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*--t)+2)},inCirc:function(t){return-(Math.sqrt(1-t*t)-1)},outCirc:function(t){return Math.sqrt(1- --t*t)},inOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},inElastic:function(t){var i=1.70158,e=0,n=1;return 0===t?0:1===t?1:(e||(e=.3),i=e/(2*Math.PI)*Math.asin(1/n),-(n*Math.pow(2,10*(t-=1))*Math.sin(2*(t-i)*Math.PI/e)))},outElastic:function(t){var i=1.70158,e=0,n=1;return 0===t?0:1===t?1:(e||(e=.3),i=e/(2*Math.PI)*Math.asin(1/n),n*Math.pow(2,-10*t)*Math.sin(2*(t-i)*Math.PI/e)+1)},inOutElastic:function(t){var i=1.70158,e=0,n=1;return 0===t?0:2===(t/=.5)?1:(e||(e=.3*1.5),i=e/(2*Math.PI)*Math.asin(1/n),1>t?-.5*n*Math.pow(2,10*(t-=1))*Math.sin(2*(t-i)*Math.PI/e):n*Math.pow(2,-10*(t-=1))*Math.sin(2*(t-i)*Math.PI/e)*.5+1)},inBack:function(t,i){return void 0===i&&(i=1.70158),t*t*((i+1)*t-i)},outBack:function(t,i){return void 0===i&&(i=1.70158),--t*t*((i+1)*t+i)+1},inOutBack:function(t,i){return void 0===i&&(i=1.70158),(t/=.5)<1?.5*t*t*(((i*=1.525)+1)*t-i):.5*((t-=2)*t*(((i*=1.525)+1)*t+i)+2)},inBounce:function(t){return 1-n.outBounce(1-t)},outBounce:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},inOutBounce:function(t){return.5>t?.5*n.inBounce(2*t):.5*n.outBounce(2*t-1)+.5}};e.exports=n}),define(function(t,i,e){function n(t){this.method=t,this._instances=[],this.state=[]}var s=t("famous/utilities/Utility");n.SUPPORTS_MULTIPLE=!0,n.prototype.get=function(){for(var t=0;t<this._instances.length;t++)this.state[t]=this._instances[t].get();return this.state},n.prototype.set=function(t,i,e){for(var n=s.after(t.length,e),o=0;o<t.length;o++)this._instances[o]||(this._instances[o]=new this.method),this._instances[o].set(t[o],i,n)},n.prototype.reset=function(t){for(var i=0;i<t.length;i++)this._instances[i]||(this._instances[i]=new this.method),this._instances[i].reset(t[i])},e.exports=n}),define(function(t,i,e){function n(t){t=t||0,this.endState=new m(t),this.initState=new m,this._dimensions=1,this._restTolerance=1e-10,this._absRestTolerance=this._restTolerance,this._callback=void 0,this.PE=new y,this.particle=new g,this.spring=new v({anchor:this.endState}),this.PE.addBody(this.particle),this.PE.attach(this.spring,this.particle)}function s(){return this.particle.getEnergy()+this.spring.getEnergy(this.particle)}function o(){var t=this.endState.sub(this.initState).normSquared();this._absRestTolerance=0===t?this._restTolerance:this._restTolerance*t}function r(t){this.endState.set(t),o.call(this)}function a(){this.PE.wake()}function h(){this.PE.sleep()}function c(t){this.particle.position.set(t)}function p(t){this.particle.velocity.set(t)}function u(){return 0===this._dimensions?this.particle.getPosition1D():this.particle.getPosition()}function l(){return 0===this._dimensions?this.particle.getVelocity1D():this.particle.getVelocity()}function f(t){this._callback=t}function d(t){var i=n.DEFAULT_OPTIONS;void 0===t.period&&(t.period=i.period),void 0===t.dampingRatio&&(t.dampingRatio=i.dampingRatio),void 0===t.velocity&&(t.velocity=i.velocity),this.spring.setOptions({period:t.period,dampingRatio:t.dampingRatio}),p.call(this,t.velocity)}function _(){if(this.PE.isSleeping()){if(this._callback){var t=this._callback;this._callback=void 0,t()}}else s.call(this)<this._absRestTolerance&&(c.call(this,this.endState),p.call(this,[0,0,0]),h.call(this))}var y=t("famous/physics/PhysicsEngine"),g=t("famous/physics/bodies/Particle"),v=t("famous/physics/constraints/Snap"),m=t("famous/math/Vector");n.SUPPORTS_MULTIPLE=3,n.DEFAULT_OPTIONS={period:100,dampingRatio:.2,velocity:0},n.prototype.reset=function(t,i){this._dimensions=t instanceof Array?t.length:0,this.initState.set(t),c.call(this,t),r.call(this,t),i&&p.call(this,i),f.call(this,void 0)},n.prototype.getVelocity=function(){return l.call(this)},n.prototype.setVelocity=function(t){this.call(this,p(t))},n.prototype.isActive=function(){return!this.PE.isSleeping()},n.prototype.halt=function(){this.set(this.get())},n.prototype.get=function(){return _.call(this),u.call(this)},n.prototype.set=function(t,i,e){return i?(this._dimensions=t instanceof Array?t.length:0,a.call(this),d.call(this,i),r.call(this,t),void f.call(this,e)):(this.reset(t),void(e&&e()))},e.exports=n}),define(function(t,i,e){function n(t){t=t||0,this.endState=new m(t),this.initState=new m,this._dimensions=void 0,this._restTolerance=1e-10,this._absRestTolerance=this._restTolerance,this._callback=void 0,this.PE=new y,this.spring=new v({anchor:this.endState}),this.particle=new g,this.PE.addBody(this.particle),this.PE.attach(this.spring,this.particle)}function s(){return this.particle.getEnergy()+this.spring.getEnergy(this.particle)}function o(t){this.particle.setPosition(t)}function r(t){this.particle.setVelocity(t)}function a(){return 0===this._dimensions?this.particle.getPosition1D():this.particle.getPosition()}function h(){return 0===this._dimensions?this.particle.getVelocity1D():this.particle.getVelocity()}function c(t){this._callback=t}function p(){this.PE.wake()}function u(){this.PE.sleep()}function l(){if(this.PE.isSleeping()){if(this._callback){var t=this._callback;this._callback=void 0,t()}}else s.call(this)<this._absRestTolerance&&(o.call(this,this.endState),r.call(this,[0,0,0]),u.call(this))}function f(t){var i=n.DEFAULT_OPTIONS;void 0===t.period&&(t.period=i.period),void 0===t.dampingRatio&&(t.dampingRatio=i.dampingRatio),void 0===t.velocity&&(t.velocity=i.velocity),t.period<150&&(t.period=150,console.warn("The period of a SpringTransition is capped at 150 ms. Use a SnapTransition for faster transitions")),this.spring.setOptions({period:t.period,dampingRatio:t.dampingRatio}),r.call(this,t.velocity)}function d(){var t=this.endState.sub(this.initState).normSquared();this._absRestTolerance=0===t?this._restTolerance:this._restTolerance*t}function _(t){this.endState.set(t),d.call(this)}var y=t("famous/physics/PhysicsEngine"),g=t("famous/physics/bodies/Particle"),v=t("famous/physics/forces/Spring"),m=t("famous/math/Vector");n.SUPPORTS_MULTIPLE=3,n.DEFAULT_OPTIONS={period:300,dampingRatio:.5,velocity:0},n.prototype.reset=function(t,i){this._dimensions=t instanceof Array?t.length:0,this.initState.set(t),o.call(this,t),_.call(this,t),i&&r.call(this,i),c.call(this,void 0)},n.prototype.getVelocity=function(){return h.call(this)},n.prototype.setVelocity=function(t){this.call(this,r(t))},n.prototype.isActive=function(){return!this.PE.isSleeping()},n.prototype.halt=function(){this.set(this.get())},n.prototype.get=function(){return l.call(this),a.call(this)},n.prototype.set=function(t,i,e){return i?(this._dimensions=t instanceof Array?t.length:0,p.call(this),f.call(this,i),_.call(this,t),void c.call(this,e)):(this.reset(t),void(e&&e()))},e.exports=n}),define(function(t,i,e){function n(t){this.currentAction=null,this.actionQueue=[],this.callbackQueue=[],this.state=0,this.velocity=void 0,this._callback=void 0,this._engineInstance=null,this._currentMethod=null,this.set(t)}function s(){if(this._callback){var t=this._callback;this._callback=void 0,t()}if(this.actionQueue.length<=0)return void this.set(this.get());this.currentAction=this.actionQueue.shift(),this._callback=this.callbackQueue.shift();var i=null,e=this.currentAction[0],n=this.currentAction[1];n instanceof Object&&n.method?(i=n.method,"string"==typeof i&&(i=a[i])):i=r,this._currentMethod!==i&&(this._engineInstance=!(e instanceof Object)||i.SUPPORTS_MULTIPLE===!0||e.length<=i.SUPPORTS_MULTIPLE?new i:new o(i),this._currentMethod=i),this._engineInstance.reset(this.state,this.velocity),void 0!==this.velocity&&(n.velocity=this.velocity),this._engineInstance.set(e,n,s.bind(this))}var o=t("./MultipleTransition"),r=t("./TweenTransition"),a={};n.registerMethod=function(t,i){return t in a?!1:(a[t]=i,!0)},n.unregisterMethod=function(t){return t in a?(delete a[t],!0):!1},n.prototype.set=function(t,i,e){if(!i)return this.reset(t),e&&e(),this;var n=[t,i];return this.actionQueue.push(n),this.callbackQueue.push(e),this.currentAction||s.call(this),this},n.prototype.reset=function(t,i){this._currentMethod=null,this._engineInstance=null,this._callback=void 0,this.state=t,this.velocity=i,this.currentAction=null,this.actionQueue=[],this.callbackQueue=[]},n.prototype.delay=function(t,i){this.set(this.get(),{duration:t,curve:function(){return 0}},i)},n.prototype.get=function(t){return this._engineInstance&&(this._engineInstance.getVelocity&&(this.velocity=this._engineInstance.getVelocity()),this.state=this._engineInstance.get(t)),this.state},n.prototype.isActive=function(){return!!this.currentAction},n.prototype.halt=function(){this.set(this.get())},e.exports=n}),define(function(t,i,e){function n(t){this._final=r.identity.slice(),this.translate=new o([0,0,0]),this.rotate=new o([0,0,0]),this.skew=new o([0,0,0]),this.scale=new o([1,1,1]),t&&this.set(t)}function s(){return r.build({translate:this.translate.get(),rotate:this.rotate.get(),skew:this.skew.get(),scale:this.scale.get()})}var o=t("./Transitionable"),r=t("famous/core/Transform"),a=t("famous/utilities/Utility");n.prototype.setTranslate=function(t,i,e){return this.translate.set(t,i,e),this._final=this._final.slice(),this._final[12]=t[0],this._final[13]=t[1],void 0!==t[2]&&(this._final[14]=t[2]),this},n.prototype.setScale=function(t,i,e){return this.scale.set(t,i,e),this._final=this._final.slice(),this._final[0]=t[0],this._final[5]=t[1],void 0!==t[2]&&(this._final[10]=t[2]),this},n.prototype.setRotate=function(t,i,e){return this.rotate.set(t,i,e),this._final=s.call(this),this._final=r.build({translate:this.translate.get(),rotate:t,scale:this.scale.get(),skew:this.skew.get()}),this},n.prototype.setSkew=function(t,i,e){return this.skew.set(t,i,e),this._final=r.build({translate:this.translate.get(),rotate:this.rotate.get(),scale:this.scale.get(),skew:t}),this},n.prototype.set=function(t,i,e){this._final=t;var n=r.interpret(t),s=e?a.after(4,e):null;return this.translate.set(n.translate,i,s),this.rotate.set(n.rotate,i,s),this.skew.set(n.skew,i,s),this.scale.set(n.scale,i,s),this},n.prototype.setDefaultTransition=function(t){this.translate.setDefault(t),this.rotate.setDefault(t),this.skew.setDefault(t),this.scale.setDefault(t)},n.prototype.get=function(){return this.isActive()?s.call(this):this._final},n.prototype.getFinal=function(){return this._final},n.prototype.isActive=function(){return this.translate.isActive()||this.rotate.isActive()||this.scale.isActive()||this.skew.isActive()},n.prototype.halt=function(){this._final=this.get(),this.translate.halt(),this.rotate.halt(),this.skew.halt(),this.scale.halt()},e.exports=n}),define(function(t,i,e){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),t&&this.setOptions(t),this._startTime=0,this._startValue=0,this._updateTime=0,this._endValue=0,this._curve=void 0,this._duration=0,this._active=!1,this._callback=void 0,this.state=0,this.velocity=void 0}function s(t,i,e){return(1-e)*t+e*i}function o(t){return t instanceof Object?t instanceof Array?t.slice(0):Object.create(t):t}function r(t,i){var e={curve:i.curve};return i.duration&&(e.duration=i.duration),i.speed&&(e.speed=i.speed),t instanceof Object&&(void 0!==t.duration&&(e.duration=t.duration),t.curve&&(e.curve=t.curve),t.speed&&(e.speed=t.speed)),"string"==typeof e.curve&&(e.curve=n.getCurve(e.curve)),e}function a(t,i,e,n,s){var o,r=1e-7,a=(e(s)-e(s-r))/r;if(t instanceof Array){o=[];for(var h=0;h<t.length;h++)o[h]="number"==typeof t[h]?a*(t[h]-i[h])/n:0}else o=a*(t-i)/n;return o}function h(t,i,e){var n;if(t instanceof Array){n=[];for(var o=0;o<t.length;o++)n[o]="number"==typeof t[o]?s(t[o],i[o],e):t[o]}else n=s(t,i,e);return n}n.Curves={linear:function(t){return t},easeIn:function(t){return t*t},easeOut:function(t){return t*(2-t)},easeInOut:function(t){return.5>=t?2*t*t:-2*t*t+4*t-1},easeOutBounce:function(t){return t*(3-2*t)},spring:function(t){return(1-t)*Math.sin(6*Math.PI*t)+t}},n.SUPPORTS_MULTIPLE=!0,n.DEFAULT_OPTIONS={curve:n.Curves.linear,duration:500,speed:0};var c={};n.registerCurve=function(t,i){return c[t]?!1:(c[t]=i,!0)},n.unregisterCurve=function(t){return c[t]?(delete c[t],!0):!1},n.getCurve=function(t){var i=c[t];if(void 0!==i)return i;throw new Error("curve not registered")},n.getCurves=function(){return c},n.prototype.setOptions=function(t){void 0!==t.curve&&(this.options.curve=t.curve),void 0!==t.duration&&(this.options.duration=t.duration),void 0!==t.speed&&(this.options.speed=t.speed)},n.prototype.set=function(t,i,e){if(!i)return this.reset(t),void(e&&e());if(this._startValue=o(this.get()),i=r(i,this.options),i.speed){var n=this._startValue;if(n instanceof Object){var s=0;for(var a in n)s+=(t[a]-n[a])*(t[a]-n[a]);i.duration=Math.sqrt(s)/i.speed}else i.duration=Math.abs(t-n)/i.speed}this._startTime=Date.now(),this._endValue=o(t),this._startVelocity=o(i.velocity),this._duration=i.duration,this._curve=i.curve,this._active=!0,this._callback=e},n.prototype.reset=function(t,i){if(this._callback){var e=this._callback;this._callback=void 0,e()}this.state=o(t),this.velocity=o(i),this._startTime=0,this._duration=0,this._updateTime=0,this._startValue=this.state,this._startVelocity=this.velocity,this._endValue=this.state,this._active=!1},n.prototype.getVelocity=function(){return this.velocity},n.prototype.get=function(t){return this.update(t),this.state},n.prototype.update=function(t){if(this._active){if(t||(t=Date.now()),!(this._updateTime>=t)){this._updateTime=t;var i=t-this._startTime;if(i>=this._duration)this.state=this._endValue,this.velocity=a(this.state,this._startValue,this._curve,this._duration,1),this._active=!1;else if(0>i)this.state=this._startValue,this.velocity=this._startVelocity;else{var e=i/this._duration;this.state=h(this._startValue,this._endValue,this._curve(e)),this.velocity=a(this.state,this._startValue,this._curve,this._duration,e)}}}else if(this._callback){var n=this._callback;this._callback=void 0,n()}},n.prototype.isActive=function(){return this._active},n.prototype.halt=function(){this.reset(this.get())},n.registerCurve("linear",n.Curves.linear),n.registerCurve("easeIn",n.Curves.easeIn),n.registerCurve("easeOut",n.Curves.easeOut),n.registerCurve("easeInOut",n.Curves.easeInOut),n.registerCurve("easeOutBounce",n.Curves.easeOutBounce),n.registerCurve("spring",n.Curves.spring),n.customCurve=function(t,i){return t=t||0,i=i||0,function(e){return t*e+(-2*t-i+3)*e*e+(t+i-2)*e*e*e
}},e.exports=n}),define(function(t,i,e){function n(t){t=t||0,this.endState=new O(t),this.initState=new O,this.spring=new v({anchor:this.endState}),this.wall=new m,this._restTolerance=1e-10,this._dimensions=1,this._absRestTolerance=this._restTolerance,this._callback=void 0,this.PE=new y,this.particle=new g,this.PE.addBody(this.particle),this.PE.attach([this.wall,this.spring],this.particle)}function s(){return this.particle.getEnergy()+this.spring.getEnergy(this.particle)}function o(){var t=this.endState.sub(this.initState).normSquared();this._absRestTolerance=0===t?this._restTolerance:this._restTolerance*t}function r(){this.PE.wake()}function a(){this.PE.sleep()}function h(t){this.endState.set(t);var i=this.endState.sub(this.initState).norm();this.wall.setOptions({distance:this.endState.norm(),normal:0===i?this.particle.velocity.normalize(-1):this.endState.sub(this.initState).normalize(-1)}),o.call(this)}function c(t){this.particle.position.set(t)}function p(t){this.particle.velocity.set(t)}function u(){return 0===this._dimensions?this.particle.getPosition1D():this.particle.getPosition()}function l(){return 0===this._dimensions?this.particle.getVelocity1D():this.particle.getVelocity()}function f(t){this._callback=t}function d(){if(this.PE.isSleeping()){if(this._callback){var t=this._callback;this._callback=void 0,t()}}else{var i=s.call(this);i<this._absRestTolerance&&(a.call(this),c.call(this,this.endState),p.call(this,[0,0,0]))}}function _(t){var i=n.DEFAULT_OPTIONS;void 0===t.period&&(t.period=i.period),void 0===t.dampingRatio&&(t.dampingRatio=i.dampingRatio),void 0===t.velocity&&(t.velocity=i.velocity),void 0===t.restitution&&(t.restitution=i.restitution),this.spring.setOptions({period:t.period,dampingRatio:t.dampingRatio}),this.wall.setOptions({restitution:t.restitution}),p.call(this,t.velocity)}var y=t("famous/physics/PhysicsEngine"),g=t("famous/physics/bodies/Particle"),v=t("famous/physics/forces/Spring"),m=t("famous/physics/constraints/Wall"),O=t("famous/math/Vector");n.SUPPORTS_MULTIPLE=3,n.DEFAULT_OPTIONS={period:300,dampingRatio:.5,velocity:0,resitution:.5},n.prototype.reset=function(t,i){this._dimensions=t instanceof Array?t.length:0,this.initState.set(t),c.call(this,t),i&&p.call(this,i),h.call(this,t),f.call(this,void 0)},n.prototype.getVelocity=function(){return l.call(this)},n.prototype.setVelocity=function(t){this.call(this,p(t))},n.prototype.isActive=function(){return!this.PE.isSleeping()},n.prototype.halt=function(){this.set(this.get())},n.prototype.get=function(){return d.call(this),u.call(this)},n.prototype.set=function(t,i,e){return i?(this._dimensions=t instanceof Array?t.length:0,r.call(this),_.call(this,i),h.call(this,t),void f.call(this,e)):(this.reset(t),void(e&&e()))},e.exports=n}),define(function(t,i,e){function n(){a.apply(this,arguments),this.title=new o({classes:this.options.classes,content:this.options.content}),this.back=new o({size:[this.options.size[1],this.options.size[1]],classes:this.options.classes,content:this.options.backContent}),this.back.on("click",function(){this._eventOutput.emit("back",{})}.bind(this)),this.more=new o({size:[this.options.size[1],this.options.size[1]],classes:this.options.classes,content:this.options.moreContent}),this.more.on("click",function(){this._eventOutput.emit("more",{})}.bind(this)),this.layout=new s({id:"master",size:this.options.size,target:[{transform:r.inFront,origin:[0,.5],target:this.back},{origin:[.5,.5],target:this.title},{transform:r.inFront,origin:[1,.5],target:this.more}]}),this._add(this.layout),this._optionsManager.on("change",function(t){var i=t.id,e=t.value;"size"===i?(this.layout.id.master.setSize(e),this.title.setSize(e),this.back.setSize([e[1],e[1]]),this.more.setSize([e[1],e[1]])):"backClasses"===i?this.back.setOptions({classes:this.options.classes.concat(this.options.backClasses)}):"backContent"===i?this.back.setContent(this.options.backContent):"classes"===i?(this.title.setOptions({classes:this.options.classes}),this.back.setOptions({classes:this.options.classes.concat(this.options.backClasses)}),this.more.setOptions({classes:this.options.classes.concat(this.options.moreClasses)})):"content"===i?this.setContent(this.options.content):"moreClasses"===i?this.more.setOptions({classes:this.options.classes.concat(this.options.moreClasses)}):"moreContent"===i&&this.more.setContent(this.options.content)}.bind(this))}var s=t("famous/core/Scene"),o=t("famous/core/Surface"),r=t("famous/core/Transform"),a=t("famous/core/View");n.prototype=Object.create(a.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={size:[void 0,50],backClasses:["back"],backContent:"&#x25c0;",classes:["navigation"],content:"",moreClasses:["more"],moreContent:"&#x271a;"},n.prototype.setContent=function(t){return this.title.setContent(t)},e.exports=n}),define(function(t,i,e){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),this.optionsManager=new p(this.options),t&&this.setOptions(t),this.indicator=new r({size:this.options.indicatorSize,classes:["slider-back"]}),this.label=new o({size:this.options.labelSize,content:this.options.label,properties:{pointerEvents:"none"},classes:["slider-label"]}),this.eventOutput=new h,this.eventInput=new h,h.setInputHandler(this,this.eventInput),h.setOutputHandler(this,this.eventOutput);var i=(this.options.range[1]-this.options.range[0])/this.options.indicatorSize[0];this.sync=new f(["mouse","touch"],{scale:i,direction:f.DIRECTION_X}),this.indicator.pipe(this.sync),this.sync.pipe(this),this.eventInput.on("update",function(t){this.set(t.position)}.bind(this)),this._drawPos=0,s.call(this)}function s(){this.label.setContent(this.options.label+'<span style="float: right">'+this.get().toFixed(this.options.precision)+"</span>")}var o=t("famous/core/Surface"),r=t("famous/surfaces/CanvasSurface"),a=t("famous/core/Transform"),h=t("famous/core/EventHandler"),c=t("famous/math/Utilities"),p=t("famous/core/OptionsManager"),u=t("famous/inputs/MouseSync"),l=t("famous/inputs/TouchSync"),f=t("famous/inputs/GenericSync");f.register({mouse:u,touch:l}),n.DEFAULT_OPTIONS={size:[200,60],indicatorSize:[200,30],labelSize:[200,30],range:[0,1],precision:2,value:0,label:"",fillColor:"rgba(170, 170, 170, 1)"},n.prototype.setOptions=function(t){return this.optionsManager.setOptions(t)},n.prototype.get=function(){return this.options.value},n.prototype.set=function(t){t!==this.options.value&&(this.options.value=c.clamp(t,this.options.range),s.call(this),this.eventOutput.emit("change",{value:t}))},n.prototype.getSize=function(){return this.options.size},n.prototype.render=function(){var t=this.options.range,i=Math.floor((this.get()-t[0])/(t[1]-t[0])*this.options.indicatorSize[0]);if(i<this._drawPos)this.indicator.getContext("2d").clearRect(i,0,this._drawPos-i+1,this.options.indicatorSize[1]);else if(i>this._drawPos){var e=this.indicator.getContext("2d");e.fillStyle=this.options.fillColor,e.fillRect(this._drawPos-1,0,i-this._drawPos+1,this.options.indicatorSize[1])}return this._drawPos=i,{size:this.options.size,target:[{origin:[0,0],target:this.indicator.render()},{transform:a.translate(0,0,1),origin:[0,0],target:this.label.render()}]}},e.exports=n}),define(function(t,i,e){function n(){a.apply(this,arguments),this.layout=new h,this.buttons=[],this._buttonIds={},this._buttonCallbacks={},this.layout.sequenceFrom(this.buttons),this._add(this.layout),this._optionsManager.on("change",s.bind(this))}function s(t){var i=t.id,e=t.value;if("direction"===i)this.layout.setOptions({dimensions:o.call(this.buttons.length,this.options.direction)});else if("buttons"===i)for(var n in this.buttons)this.buttons[n].setOptions(e);else if("sections"===i)for(var s in this.options.sections)this.defineSection(s,this.options.sections[s])}function o(t,i){return i===r.Direction.X?[t,1]:[1,t]}var r=t("famous/utilities/Utility"),a=t("famous/core/View"),h=t("famous/views/GridLayout"),c=t("./ToggleButton");n.prototype=Object.create(a.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={sections:[],widget:c,size:[void 0,50],direction:r.Direction.X,buttons:{toggleMode:c.ON}},n.prototype.defineSection=function(t,i){var e,n=this._buttonIds[t];if(void 0===n){n=this.buttons.length,this._buttonIds[t]=n;var s=this.options.widget;e=new s,this.buttons[n]=e,this.layout.setOptions({dimensions:o(this.buttons.length,this.options.direction)})}else e=this.buttons[n],e.unbind("select",this._buttonCallbacks[t]);this.options.buttons&&e.setOptions(this.options.buttons),e.setOptions(i),this._buttonCallbacks[t]=this.select.bind(this,t),e.on("select",this._buttonCallbacks[t])},n.prototype.select=function(t){var i=this._buttonIds[t];this.buttons[i]&&this.buttons[i].isSelected()?this._eventOutput.emit("select",{id:t}):this.buttons[i]&&this.buttons[i].select();for(var e=0;e<this.buttons.length;e++)e!==i&&this.buttons[e].deselect()},e.exports=n}),define(function(t,i,e){function n(t){this.options={content:"",offClasses:["off"],onClasses:["on"],size:void 0,outTransition:{curve:"easeInOut",duration:300},inTransition:{curve:"easeInOut",duration:300},toggleMode:n.TOGGLE,crossfade:!0},this._eventOutput=new o,o.setOutputHandler(this,this._eventOutput),this.offSurface=new s,this.offSurface.on("click",function(){this.options.toggleMode!==n.OFF&&this.select()}.bind(this)),this.offSurface.pipe(this._eventOutput),this.onSurface=new s,this.onSurface.on("click",function(){this.options.toggleMode!==n.ON&&this.deselect()}.bind(this)),this.onSurface.pipe(this._eventOutput),this.arbiter=new r({overlap:this.options.crossfade}),this.deselect(),t&&this.setOptions(t)}var s=t("famous/core/Surface"),o=t("famous/core/EventHandler"),r=t("famous/views/RenderController");n.OFF=0,n.ON=1,n.TOGGLE=2,n.prototype.select=function(){this.selected=!0,this.arbiter.show(this.onSurface,this.options.inTransition),this._eventOutput.emit("select")},n.prototype.deselect=function(){this.selected=!1,this.arbiter.show(this.offSurface,this.options.outTransition),this._eventOutput.emit("deselect")},n.prototype.isSelected=function(){return this.selected},n.prototype.setOptions=function(t){void 0!==t.content&&(this.options.content=t.content,this.offSurface.setContent(this.options.content),this.onSurface.setContent(this.options.content)),t.offClasses&&(this.options.offClasses=t.offClasses,this.offSurface.setClasses(this.options.offClasses)),t.onClasses&&(this.options.onClasses=t.onClasses,this.onSurface.setClasses(this.options.onClasses)),void 0!==t.size&&(this.options.size=t.size,this.onSurface.setSize(this.options.size),this.offSurface.setSize(this.options.size)),void 0!==t.toggleMode&&(this.options.toggleMode=t.toggleMode),void 0!==t.outTransition&&(this.options.outTransition=t.outTransition),void 0!==t.inTransition&&(this.options.inTransition=t.inTransition),void 0!==t.crossfade&&(this.options.crossfade=t.crossfade,this.arbiter.setOptions({overlap:this.options.crossfade}))},n.prototype.getSize=function(){return this.options.size},n.prototype.render=function(){return this.arbiter.render()},e.exports=n}),define(function(t,i,e){function n(t){this.options=Object.create(this.constructor.DEFAULT_OPTIONS||n.DEFAULT_OPTIONS),this._optionsManager=new r(this.options),t&&this.setOptions(t),this._eventInput=new o,this._eventOutput=new o,o.setInputHandler(this,this._eventInput),o.setOutputHandler(this,this._eventOutput),this._id=s.register(this)}var s=t("famous/core/Entity"),o=(t("famous/core/Transform"),t("famous/core/EventHandler")),r=t("famous/core/OptionsManager");n.DEFAULT_OPTIONS={},n.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},n.prototype.getOptions=function(){return this._optionsManager.getOptions()},n.prototype.render=function(){return this._id},n.prototype.commit=function(){},e.exports=n}),define(function(t,i,e){function n(){p.apply(this,arguments),this.state=new h(0),this._isOpen=!1,this.setOutputFunction(function(t,i,e){var n=s.call(this),o=this.options.direction===c.Direction.X?r.translate(n*i,0,.001*(n-1)*i):r.translate(0,n*i,.001*(n-1)*i),a=t.render();if(this.options.stackRotation){var h=this.options.stackRotation*e*(1-n);a={transform:r.rotateZ(h),origin:[.5,.5],target:a}}return{transform:o,size:t.getSize(),target:a}})}function s(t){return t?this._isOpen?1:0:this.state.get()}function o(t,i,e){this.state.halt(),this.state.set(t,i,e)}var r=t("famous/core/Transform"),a=t("famous/core/OptionsManager"),h=t("famous/transitions/Transitionable"),c=t("famous/utilities/Utility"),p=t("./SequentialLayout");n.prototype=Object.create(p.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS=a.patch(p.DEFAULT_OPTIONS,{transition:{curve:"easeOutBounce",duration:500},stackRotation:0}),n.prototype.getSize=function(){var t=p.prototype.getSize.apply(this,arguments),i=this._items?this._items.get().getSize():[0,0];i||(i=[0,0]);var e=s.call(this),n=1-e;return[i[0]*n+t[0]*e,i[1]*n+t[1]*e]},n.prototype.isOpen=function(){return this._isOpen},n.prototype.open=function(t){this._isOpen=!0,o.call(this,1,this.options.transition,t)},n.prototype.close=function(t){this._isOpen=!1,o.call(this,0,this.options.transition,t)},n.prototype.toggle=function(t){this._isOpen?this.close(t):this.open(t)},e.exports=n}),define(function(t,i,e){function n(t){this._currentTarget=null,this._size=[void 0,void 0],this._controller=new c(t),this._controller.inTransformFrom(o.create(s.bind(this,1e-4))),this._controller.outTransformFrom(o.create(s.bind(this,-1e-4))),this._eventInput=new a,a.setInputHandler(this,this._eventInput),this._entityId=r.register(this),t&&this.setOptions(t)}function s(t,i){return h.translate(this._size[0]*(1-i),0,t*(1-i))}var o=t("famous/transitions/CachedMap"),r=t("famous/core/Entity"),a=t("famous/core/EventHandler"),h=t("famous/core/Transform"),c=t("./RenderController");n.prototype.show=function(t){this._currentTarget&&this._eventInput.unpipe(this._currentTarget),this._currentTarget=t,this._currentTarget&&this._currentTarget.trigger&&this._eventInput.pipe(this._currentTarget),this._controller.show.apply(this._controller,arguments)},n.prototype.setOptions=function(t){this._controller.setOptions(t)},n.prototype.render=function(){return this._entityId},n.prototype.commit=function(t){return this._size[0]=t.size[0],this._size[1]=t.size[1],{transform:t.transform,opacity:t.opacity,origin:t.origin,size:t.size,target:this._controller.render()}},e.exports=n}),define(function(t,i,e){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),this.optionsManager=new a(this.options),t&&this.setOptions(t),this.id=o.register(this),this._ratios=new c(this.options.ratios),this._nodes=[],this._cachedDirection=null,this._cachedTotalLength=!1,this._cachedLengths=[],this._cachedTransforms=null,this._ratiosDirty=!1,this._eventOutput=new h,h.setOutputHandler(this,this._eventOutput)}function s(t,i,e){var s,o,a,h,c=0,p=i,u=0;for(this._cachedLengths=[],this._cachedTransforms=[],h=0;h<t.length;h++)o=t[h],a=this._nodes[h],"number"!=typeof o?p-=a.getSize()[e]||0:u+=o;for(h=0;h<t.length;h++)a=this._nodes[h],o=t[h],i="number"==typeof o?p*o/u:a.getSize()[e],s=e===n.DIRECTION_X?r.translate(c,0,0):r.translate(0,c,0),this._cachedTransforms.push(s),this._cachedLengths.push(i),c+=i}var o=t("famous/core/Entity"),r=t("famous/core/Transform"),a=t("famous/core/OptionsManager"),h=t("famous/core/EventHandler"),c=t("famous/transitions/Transitionable");n.DIRECTION_X=0,n.DIRECTION_Y=1,n.DEFAULT_OPTIONS={direction:n.DIRECTION_X,transition:!1,ratios:[]},n.prototype.render=function(){return this.id},n.prototype.setOptions=function(t){this.optionsManager.setOptions(t)},n.prototype.sequenceFrom=function(t){if(this._nodes=t,0===this._ratios.get().length){for(var i=[],e=0;e<this._nodes.length;e++)i.push(1);this.setRatios(i)}},n.prototype.setRatios=function(t,i,e){void 0===i&&(i=this.options.transition);var n=this._ratios;0===n.get().length&&(i=void 0),n.isActive()&&n.halt(),n.set(t,i,e),this._ratiosDirty=!0},n.prototype.commit=function(t){var i,e=t.size,n=t.transform,o=t.origin,a=this._ratios.get(),h=this.options.direction,c=e[h];(c!==this._cachedTotalLength||this._ratiosDirty||this._ratios.isActive()||h!==this._cachedDirection)&&(s.call(this,a,c,h),c!==this._cachedTotalLength&&(this._cachedTotalLength=c),h!==this._cachedDirection&&(this._cachedDirection=h),this._ratiosDirty&&(this._ratiosDirty=!1));for(var p=[],u=0;u<a.length;u++)i=[void 0,void 0],c=this._cachedLengths[u],i[h]=c,p.push({transform:this._cachedTransforms[u],size:i,target:this._nodes[u].render()});return e&&0!==o[0]&&0!==o[1]&&(n=r.moveThen([-e[0]*o[0],-e[1]*o[1],0],n)),{transform:n,size:e,target:p}},e.exports=n}),define(function(t,i,e){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),this._optionsManager=new r(this.options),t&&this.setOptions(t),this.angle=new o(0),this.frontNode=void 0,this.backNode=void 0,this.flipped=!1}var s=t("famous/core/Transform"),o=t("famous/transitions/Transitionable"),r=(t("famous/core/RenderNode"),t("famous/core/OptionsManager"));n.DIRECTION_X=0,n.DIRECTION_Y=1;var a=1;n.DEFAULT_OPTIONS={transition:!0,direction:n.DIRECTION_X},n.prototype.flip=function(t,i){var e=this.flipped?0:Math.PI;this.setAngle(e,t,i),this.flipped=!this.flipped},n.prototype.setAngle=function(t,i,e){void 0===i&&(i=this.options.transition),this.angle.isActive()&&this.angle.halt(),this.angle.set(t,i,e)},n.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},n.prototype.setFront=function(t){this.frontNode=t},n.prototype.setBack=function(t){this.backNode=t},n.prototype.render=function(){var t,i,e=this.angle.get();this.options.direction===n.DIRECTION_X?(t=s.rotateY(e),i=s.rotateY(e+Math.PI)):(t=s.rotateX(e),i=s.rotateX(e+Math.PI));var o=[];return this.frontNode&&o.push({transform:t,target:this.frontNode.render()}),this.backNode&&o.push({transform:s.moveThen([0,0,a],i),target:this.backNode.render()}),o},e.exports=n}),define(function(t,i,e){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),this.optionsManager=new l(this.options),t&&this.setOptions(t),this.id=a.register(this),this._modifiers=[],this._states=[],this._contextSizeCache=[0,0],this._dimensionsCache=[0,0],this._activeCount=0,this._eventOutput=new p,p.setOutputHandler(this,this._eventOutput)}function s(t,i,e){var n=[t[0],t[1]];n[0]-=this.options.gutterSize[0]*(i-1),n[1]-=this.options.gutterSize[1]*(e-1);for(var s,a=Math.round(n[1]/e),h=Math.round(n[0]/i),c=0,p=0,u=0;e>u;u++){s=0;for(var l=0;i>l;l++)void 0===this._modifiers[p]?o.call(this,p,[h,a],[s,c,0],1):r.call(this,p,[h,a],[s,c,0],1),p++,s+=h+this.options.gutterSize[0];c+=a+this.options.gutterSize[1]}for(this._dimensionsCache=[this.options.dimensions[0],this.options.dimensions[1]],this._contextSizeCache=[t[0],t[1]],this._activeCount=e*i,u=this._activeCount;u<this._modifiers.length;u++)r.call(this,u,[Math.round(h),Math.round(a)],[0,0],0);this._eventOutput.emit("reflow")}function o(t,i,e,n){var s={transform:new d(h.translate.apply(null,e)),opacity:new f(n),size:new f(i)},o=new u({transform:s.transform,opacity:s.opacity,size:s.size});this._states[t]=s,this._modifiers[t]=o}function r(t,i,e,n){var s=this._states[t],o=s.size,r=s.opacity,a=s.transform,h=this.options.transition;a.halt(),r.halt(),o.halt(),a.setTranslate(e,h),o.set(i,h),r.set(n,h)}var a=t("famous/core/Entity"),h=(t("famous/core/RenderNode"),t("famous/core/Transform")),c=t("famous/core/ViewSequence"),p=t("famous/core/EventHandler"),u=t("famous/core/Modifier"),l=t("famous/core/OptionsManager"),f=t("famous/transitions/Transitionable"),d=t("famous/transitions/TransitionableTransform");n.DEFAULT_OPTIONS={dimensions:[1,1],transition:!1,gutterSize:[0,0]},n.prototype.render=function(){return this.id},n.prototype.setOptions=function(t){return this.optionsManager.setOptions(t)},n.prototype.sequenceFrom=function(t){t instanceof Array&&(t=new c(t)),this.sequence=t},n.prototype.commit=function(t){var i=t.transform,e=t.opacity,n=t.origin,o=t.size,r=this.options.dimensions[0],a=this.options.dimensions[1];(o[0]!==this._contextSizeCache[0]||o[1]!==this._contextSizeCache[1]||r!==this._dimensionsCache[0]||a!==this._dimensionsCache[1])&&s.call(this,o,r,a);for(var c=this.sequence,p=[],u=0;c&&u<this._modifiers.length;){var l=c.get(),f=this._modifiers[u];u>=this._activeCount&&this._states[u].opacity.isActive()&&(this._modifiers.splice(u,1),this._states.splice(u,1)),l&&p.push(f.modify({origin:n,target:l.render()})),c=c.getNext(),u++}return o&&(i=h.moveThen([-o[0]*n[0],-o[1]*n[1],0],i)),{transform:i,opacity:e,size:o,target:p}},e.exports=n}),define(function(t,i,e){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),this._optionsManager=new p(this.options),t&&this.setOptions(t),this._entityId=a.register(this),this.header=new h,this.footer=new h,this.content=new h}function s(t,i){var e=t.getSize();return e?e[this.options.direction]:i}function o(t){return this.options.direction===n.DIRECTION_X?c.translate(t,0,0):c.translate(0,t,0)}function r(t,i){return this.options.direction===n.DIRECTION_X?[t,i[1]]:[i[0],t]}var a=t("famous/core/Entity"),h=t("famous/core/RenderNode"),c=t("famous/core/Transform"),p=t("famous/core/OptionsManager");n.DIRECTION_X=0,n.DIRECTION_Y=1,n.DEFAULT_OPTIONS={direction:n.DIRECTION_Y,headerSize:void 0,footerSize:void 0,defaultHeaderSize:0,defaultFooterSize:0},n.prototype.render=function(){return this._entityId},n.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},n.prototype.commit=function(t){var i=t.transform,e=t.origin,n=t.size,a=t.opacity,h=void 0!==this.options.headerSize?this.options.headerSize:s.call(this,this.header,this.options.defaultHeaderSize),p=void 0!==this.options.footerSize?this.options.footerSize:s.call(this,this.footer,this.options.defaultFooterSize),u=n[this.options.direction]-h-p;n&&(i=c.moveThen([-n[0]*e[0],-n[1]*e[1],0],i));var l=[{size:r.call(this,h,n),target:this.header.render()},{transform:o.call(this,h),size:r.call(this,u,n),target:this.content.render()},{transform:o.call(this,h+u),size:r.call(this,p,n),target:this.footer.render()}];return{transform:i,opacity:a,size:n,target:l}},e.exports=n}),define(function(t,i,e){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),this._optionsManager=new h(this.options),t&&this.setOptions(t),this._showing=!1,this.nodes=[],this.transforms=[],this.states=[]}var s=t("famous/core/Transform"),o=t("famous/core/Modifier"),r=t("famous/core/RenderNode"),a=t("famous/utilities/Utility"),h=t("famous/core/OptionsManager"),c=t("famous/transitions/Transitionable"),p=t("famous/transitions/TransitionableTransform");n.DEFAULT_OPTIONS={inTransform:s.scale(.001,.001,.001),inOpacity:0,inOrigin:[.5,.5],outTransform:s.scale(.001,.001,.001),outOpacity:0,outOrigin:[.5,.5],showTransform:s.identity,showOpacity:1,showOrigin:[.5,.5],inTransition:!0,outTransition:!0,overlap:!1},n.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},n.prototype.show=function(t,i,e){if(!t)return this.hide(e);if(i instanceof Function&&(e=i,i=void 0),this._showing){if(!this.options.overlap)return this.hide(this.show.bind(this,t,i,e));this.hide()}this._showing=!0;var n={transform:new p(this.options.inTransform),origin:new c(this.options.inOrigin),opacity:new c(this.options.inOpacity)},s=new o({transform:n.transform,opacity:n.opacity,origin:n.origin}),h=new r;h.add(s).add(t),this.nodes.push(h),this.states.push(n),this.transforms.push(s);var u=e?a.after(3,e):void 0;i||(i=this.options.inTransition),n.transform.set(this.options.showTransform,i,u),n.opacity.set(this.options.showOpacity,i,u),n.origin.set(this.options.showOrigin,i,u)},n.prototype.hide=function(t,i){if(this._showing){this._showing=!1,t instanceof Function&&(i=t,t=void 0);var e=this.nodes[this.nodes.length-1],n=this.transforms[this.transforms.length-1],s=this.states[this.states.length-1],o=a.after(3,function(){this.nodes.splice(this.nodes.indexOf(e),1),this.states.splice(this.states.indexOf(s),1),this.transforms.splice(this.transforms.indexOf(n),1),i&&i.call(this)}.bind(this));t||(t=this.options.outTransition),s.transform.set(this.options.outTransform,t,o),s.opacity.set(this.options.outOpacity,t,o),s.origin.set(this.options.outOrigin,t,o)}},n.prototype.render=function(){for(var t=[],i=0;i<this.nodes.length;i++)t.push(this.nodes[i].render());return t},e.exports=n}),define(function(t,i,e){function n(){c.apply(this,arguments),this._showing=-1,this._outgoingRenderables=[],this._nextRenderable=null,this._renderables=[],this._nodes=[],this._modifiers=[],this._states=[],this.inTransformMap=n.DefaultMap.transform,this.inOpacityMap=n.DefaultMap.opacity,this.inOriginMap=n.DefaultMap.origin,this.outTransformMap=n.DefaultMap.transform,this.outOpacityMap=n.DefaultMap.opacity,this.outOriginMap=n.DefaultMap.origin,this._output=[]}function s(t,i){return t(i.get())}var o=t("famous/core/Modifier"),r=t("famous/core/RenderNode"),a=t("famous/core/Transform"),h=t("famous/transitions/Transitionable"),c=t("famous/core/View");n.prototype=Object.create(c.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={inTransition:!0,outTransition:!0,overlap:!0},n.DefaultMap={transform:function(){return a.identity},opacity:function(t){return t},origin:null},n.prototype.inTransformFrom=function(t){if(t instanceof Function)this.inTransformMap=t;else{if(!t||!t.get)throw new Error("inTransformFrom takes only function or getter object");this.inTransformMap=t.get.bind(t)}return this},n.prototype.inOpacityFrom=function(t){if(t instanceof Function)this.inOpacityMap=t;else{if(!t||!t.get)throw new Error("inOpacityFrom takes only function or getter object");this.inOpacityMap=t.get.bind(t)}return this},n.prototype.inOriginFrom=function(t){if(t instanceof Function)this.inOriginMap=t;else{if(!t||!t.get)throw new Error("inOriginFrom takes only function or getter object");this.inOriginMap=t.get.bind(t)}return this},n.prototype.outTransformFrom=function(t){if(t instanceof Function)this.outTransformMap=t;else{if(!t||!t.get)throw new Error("inTransformFrom takes only function or getter object");this.outTransformMap=t.get.bind(t)}return this},n.prototype.outOpacityFrom=function(t){if(t instanceof Function)this.outOpacityMap=t;else{if(!t||!t.get)throw new Error("inOpacityFrom takes only function or getter object");this.outOpacityMap=t.get.bind(t)}return this},n.prototype.outOriginFrom=function(t){if(t instanceof Function)this.outOriginMap=t;else{if(!t||!t.get)throw new Error("inOriginFrom takes only function or getter object");this.outOriginMap=t.get.bind(t)}return this},n.prototype.show=function(t,i,e){if(!t)return this.hide(e);if(i instanceof Function&&(e=i,i=null),this._showing>=0){if(!this.options.overlap)return void(this._nextRenderable?this._nextRenderable=t:(this._nextRenderable=t,this.hide(function(){this._nextRenderable===t&&this.show(this._nextRenderable,e),this._nextRenderable=null})));this.hide()}var n=null,a=this._renderables.indexOf(t);if(a>=0){this._showing=a,n=this._states[a],n.halt();var c=this._outgoingRenderables.indexOf(t);c>=0&&this._outgoingRenderables.splice(c,1)}else{n=new h(0);var p=new o({transform:this.inTransformMap?s.bind(this,this.inTransformMap,n):null,opacity:this.inOpacityMap?s.bind(this,this.inOpacityMap,n):null,origin:this.inOriginMap?s.bind(this,this.inOriginMap,n):null}),u=new r;u.add(p).add(t),this._showing=this._nodes.length,this._nodes.push(u),this._modifiers.push(p),this._states.push(n),this._renderables.push(t)}i||(i=this.options.inTransition),n.set(1,i,e)},n.prototype.hide=function(t,i){if(!(this._showing<0)){var e=this._showing;this._showing=-1,t instanceof Function&&(i=t,t=void 0);var n=this._nodes[e],o=this._modifiers[e],r=this._states[e],a=this._renderables[e];o.transformFrom(this.outTransformMap?s.bind(this,this.outTransformMap,r):null),o.opacityFrom(this.outOpacityMap?s.bind(this,this.outOpacityMap,r):null),o.originFrom(this.outOriginMap?s.bind(this,this.outOriginMap,r):null),this._outgoingRenderables.indexOf(a)<0&&this._outgoingRenderables.push(a),t||(t=this.options.outTransition),r.halt(),r.set(0,t,function(t,e,n,s){if(this._outgoingRenderables.indexOf(s)>=0){var o=this._nodes.indexOf(t);this._nodes.splice(o,1),this._modifiers.splice(o,1),this._states.splice(o,1),this._renderables.splice(o,1),this._outgoingRenderables.splice(this._outgoingRenderables.indexOf(s),1),this._showing>=o&&this._showing--}i&&i.call(this)}.bind(this,n,o,r,a))}},n.prototype.render=function(){var t=this._output;t.length>this._nodes.length&&t.splice(this._nodes.length);for(var i=0;i<this._nodes.length;i++)t[i]=this._nodes[i].render();return t},e.exports=n}),define(function(t,i,e){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),this._optionsManager=new h(this.options),t&&this.setOptions(t),this.container=new s(this.options.container),this.scrollview=new r(this.options.scrollview),this.container.add(this.scrollview),o.setInputHandler(this,this.scrollview),o.setOutputHandler(this,this.scrollview),this.scrollview.subscribe(this.container)}var s=t("famous/surfaces/ContainerSurface"),o=t("famous/core/EventHandler"),r=t("./Scrollview"),a=t("famous/utilities/Utility"),h=t("famous/core/OptionsManager");n.DEFAULT_OPTIONS={container:{properties:{overflow:"hidden"}},scrollview:{direction:a.Direction.X}},n.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},n.prototype.sequenceFrom=function(){return this.scrollview.sequenceFrom.apply(this.scrollview,arguments)},n.prototype.render=function(){return this.container.render.apply(this.container,arguments)},e.exports=n}),define(function(t,i,e){function n(t){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),this._optionsManager=new u(this.options),t&&this._optionsManager.setOptions(t),this._node=null,this._position=0,this._positionOffset=0,this._positionGetter=null,this._outputFunction=null,this._masterOutputFunction=null,this.outputFrom(),this._onEdge=0,this.group=new p,this.group.add({render:h.bind(this)}),this._entityId=c.register(this),this._size=[void 0,void 0],this._contextSize=[void 0,void 0],this._eventInput=new _,this._eventOutput=new _,_.setInputHandler(this,this._eventInput),_.setOutputHandler(this,this._eventOutput)}function s(t){t||(t=this._contextSize);var i=this.options.direction===f.Direction.X?0:1;return void 0===t[i]?this._contextSize[i]:t[i]}function o(t,i,e){var n=t.getSize?t.getSize():this._contextSize,o=this._outputFunction(i);return e.push({transform:o,target:t.render()}),s.call(this,n)}function r(){return this.options.clipSize?this.options.clipSize:s.call(this,this._contextSize)}function a(){for(var t=s.call(this,this._node.getSize()),i=this._node&&this._node.getNext?this._node.getNext():null;i&&this._position+this._positionOffset>=t;)this._positionOffset-=t,this._node=i,t=s.call(this,this._node.getSize()),i=this._node&&this._node.getNext?this._node.getNext():null;for(var e=this._node&&this._node.getPrevious?this._node.getPrevious():null;e&&this._position+this._positionOffset<0;){var n=s.call(this,e.getSize());this._positionOffset+=n,this._node=e,e=this._node&&this._node.getPrevious?this._node.getPrevious():null}}function h(){var t=null,i=this._position,e=[];this._onEdge=0;for(var n=-this._positionOffset,h=r.call(this),c=this._node;c&&n-i<h+this.options.margin;)n+=o.call(this,c,n,e),c=c.getNext?c.getNext():null;var p=this._node,u=s.call(this,p.getSize());if(h>n){for(;p&&h>u;)p=p.getPrevious(),p&&(u+=s.call(this,p.getSize()));for(p=this._node;p&&h>u;)p=p.getNext(),p&&(u+=s.call(this,p.getSize()))}var l=void 0!==u&&h>u?u:h;for(!c&&l>=n-i?(this._onEdge=1,this._eventOutput.emit("edgeHit",{position:n-l})):!this._node.getPrevious()&&0>=i&&(this._onEdge=-1,this._eventOutput.emit("edgeHit",{position:0})),c=this._node&&this._node.getPrevious?this._node.getPrevious():null,n=-this._positionOffset,c&&(t=c.getSize?c.getSize():this._contextSize,n-=s.call(this,t));c&&n-i>-(r.call(this)+this.options.margin);)o.call(this,c,n,e),c=c.getPrevious?c.getPrevious():null,c&&(t=c.getSize?c.getSize():this._contextSize,n-=s.call(this,t));return a.call(this),e}var c=t("famous/core/Entity"),p=t("famous/core/Group"),u=t("famous/core/OptionsManager"),l=t("famous/core/Transform"),f=t("famous/utilities/Utility"),d=t("famous/core/ViewSequence"),_=t("famous/core/EventHandler");
n.DEFAULT_OPTIONS={direction:f.Direction.Y,margin:0,clipSize:void 0,groupScroll:!1},n.prototype.setOptions=function(t){this._optionsManager.setOptions(t),this.options.groupScroll?this.group.pipe(this._eventOutput):this.group.unpipe(this._eventOutput)},n.prototype.onEdge=function(){return this._onEdge},n.prototype.outputFrom=function(t,i){t||(t=function(t){return this.options.direction===f.Direction.X?l.translate(t,0):l.translate(0,t)}.bind(this),i||(i=t)),this._outputFunction=t,this._masterOutputFunction=i?i:function(i){return l.inverse(t(-i))}},n.prototype.positionFrom=function(t){t instanceof Function?this._positionGetter=t:t&&t.get?this._positionGetter=t.get.bind(t):(this._positionGetter=null,this._position=t),this._positionGetter&&(this._position=this._positionGetter.call(this))},n.prototype.sequenceFrom=function(t){t instanceof Array&&(t=new d({array:t})),this._node=t,this._positionOffset=0},n.prototype.getSize=function(t){return t?this._contextSize:this._size},n.prototype.render=function(){return this._node?(this._positionGetter&&(this._position=this._positionGetter.call(this)),this._entityId):null},n.prototype.commit=function(t){var i=t.transform,e=t.opacity,n=t.origin,s=t.size;this.options.clipSize||s[0]===this._contextSize[0]&&s[1]===this._contextSize[1]||(this._onEdge=0,this._contextSize[0]=s[0],this._contextSize[1]=s[1],this.options.direction===f.Direction.X?(this._size[0]=r.call(this),this._size[1]=void 0):(this._size[0]=void 0,this._size[1]=r.call(this)));var o=this._masterOutputFunction(-this._position);return{transform:l.multiply(i,o),size:s,opacity:e,origin:n,target:this.group.render()}},e.exports=n}),define(function(t,i,e){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),this._optionsManager=new T(this.options),this._node=null,this._physicsEngine=new y,this._particle=new g,this._physicsEngine.addBody(this._particle),this.spring=new m({anchor:[0,0,0]}),this.drag=new v({forceFunction:v.FORCE_FUNCTIONS.QUADRATIC}),this.friction=new v({forceFunction:v.FORCE_FUNCTIONS.LINEAR}),this.sync=new I(["scroll","touch"],{direction:this.options.direction}),this._eventInput=new O,this._eventOutput=new O,this._eventInput.pipe(this.sync),this.sync.pipe(this._eventInput),O.setInputHandler(this,this._eventInput),O.setOutputHandler(this,this._eventOutput),this._touchCount=0,this._springState=0,this._onEdge=0,this._pageSpringPosition=0,this._edgeSpringPosition=0,this._touchVelocity=void 0,this._earlyEnd=!1,this._needsPaginationCheck=!1,this._scroller=new w,this._scroller.positionFrom(this.getPosition.bind(this)),this.setOptions(t),a.call(this)}function s(t){this._touchCount=t.count,void 0===t.count&&(this._touchCount=1),c.call(this),this.setVelocity(0),this._touchVelocity=0,this._earlyEnd=!1}function o(t){var i=-t.velocity,e=-t.delta;this._onEdge&&t.slip&&(0>i&&this._onEdge<0||i>0&&this._onEdge>0?this._earlyEnd||(r.call(this,t),this._earlyEnd=!0):this._earlyEnd&&Math.abs(i)>Math.abs(this.getVelocity())&&s.call(this,t)),this._earlyEnd||(this._touchVelocity=i,t.slip?this.setVelocity(i):this.setPosition(this.getPosition()+e))}function r(t){if(this._touchCount=t.count||0,!this._touchCount){c.call(this),this._onEdge&&f.call(this,this._edgeSpringPosition,M.EDGE),h.call(this);var i=-t.velocity,e=this.options.speedLimit;t.slip&&(e*=this.options.edgeGrip),-e>i?i=-e:i>e&&(i=e),this.setVelocity(i),this._touchVelocity=void 0,this._needsPaginationCheck=!0}}function a(){this._eventInput.bindThis(this),this._eventInput.on("start",s),this._eventInput.on("update",o),this._eventInput.on("end",r),this._scroller.on("edgeHit",function(t){this._edgeSpringPosition=t.position}.bind(this))}function h(){this._springState?this._physicsEngine.attach([this.spring],this._particle):this._physicsEngine.attach([this.drag,this.friction],this._particle)}function c(){this._springState=M.NONE,this._physicsEngine.detachAll()}function p(t){var i=this.options.direction,e=(t.getSize()||this._scroller.getSize())[i];return e||(e=this._scroller.getSize()[i]),e}function u(t){!this._onEdge&&t?(this.sync.setOptions({scale:this.options.edgeGrip}),this._touchCount||this._springState===M.EDGE||f.call(this,this._edgeSpringPosition,M.EDGE)):this._onEdge&&!t&&(this.sync.setOptions({scale:1}),this._springState&&Math.abs(this.getVelocity())<.001&&(c.call(this),h.call(this))),this._onEdge=t}function l(){if(this._needsPaginationCheck&&!this._touchCount&&this._springState!==M.EDGE){var t=this.getVelocity();if(!(Math.abs(t)>=this.options.pageStopSpeed)){var i=this.getPosition(),e=Math.abs(t)>this.options.pageSwitchSpeed,n=p.call(this,this._node),s=i>.5*n,o=t>0;s&&!e||e&&o?this.goToNextPage():f.call(this,0,M.PAGE),this._needsPaginationCheck=!1}}}function f(t,i){var e;i===M.EDGE?(this._edgeSpringPosition=t,e={anchor:[this._edgeSpringPosition,0,0],period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}):i===M.PAGE&&(this._pageSpringPosition=t,e={anchor:[this._pageSpringPosition,0,0],period:this.options.pagePeriod,dampingRatio:this.options.pageDamp}),this.spring.setOptions(e),i&&!this._springState&&(c.call(this),this._springState=i,h.call(this)),this._springState=i}function d(){for(var t=this.getPosition(),i=p.call(this,this._node),e=this._node.getNext();t>i+z&&e;)_.call(this,-i),t-=i,this._scroller.sequenceFrom(e),this._node=e,e=this._node.getNext(),i=p.call(this,this._node);for(var n,s=this._node.getPrevious();-z>t&&s;)n=p.call(this,s),this._scroller.sequenceFrom(s),this._node=s,_.call(this,n),t+=n,s=this._node.getPrevious()}function _(t){this._edgeSpringPosition+=t,this._pageSpringPosition+=t,this.setPosition(this.getPosition()+t),this._springState===M.EDGE?this.spring.setOptions({anchor:[this._edgeSpringPosition,0,0]}):this._springState===M.PAGE&&this.spring.setOptions({anchor:[this._pageSpringPosition,0,0]})}var y=t("famous/physics/PhysicsEngine"),g=t("famous/physics/bodies/Particle"),v=t("famous/physics/forces/Drag"),m=t("famous/physics/forces/Spring"),O=t("famous/core/EventHandler"),T=t("famous/core/OptionsManager"),S=t("famous/core/ViewSequence"),w=t("famous/views/Scroller"),b=t("famous/utilities/Utility"),I=t("famous/inputs/GenericSync"),E=t("famous/inputs/ScrollSync"),x=t("famous/inputs/TouchSync");I.register({scroll:E,touch:x});var z=.5;n.DEFAULT_OPTIONS={direction:b.Direction.Y,rails:!0,friction:.001,drag:1e-4,edgeGrip:.5,edgePeriod:300,edgeDamp:1,margin:1e3,paginated:!1,pagePeriod:500,pageDamp:.8,pageStopSpeed:10,pageSwitchSpeed:.5,speedLimit:10,groupScroll:!1};var M={NONE:0,EDGE:1,PAGE:2};n.prototype.outputFrom=function(){return this._scroller.outputFrom.apply(this._scroller,arguments)},n.prototype.getPosition=function(){return this._particle.getPosition1D()},n.prototype.setPosition=function(t){this._particle.setPosition1D(t)},n.prototype.getVelocity=function(){return this._touchCount?this._touchVelocity:this._particle.getVelocity1D()},n.prototype.setVelocity=function(t){this._particle.setVelocity1D(t)},n.prototype.setOptions=function(t){t&&(void 0!==t.direction&&("x"===t.direction?t.direction=b.Direction.X:"y"===t.direction&&(t.direction=b.Direction.Y)),this._scroller.setOptions(t),this._optionsManager.setOptions(t)),this._scroller.setOptions(this.options),this.options.groupScroll?this._scroller.pipe(this._eventInput):this._scroller.unpipe(this._eventInput),this.drag.setOptions({strength:this.options.drag}),this.friction.setOptions({strength:this.options.friction}),this.spring.setOptions({period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}),this.sync.setOptions({rails:this.options.rails,direction:this.options.direction===b.Direction.X?I.DIRECTION_X:I.DIRECTION_Y})},n.prototype.goToPreviousPage=function(){if(!this._node)return null;var t=this._node.getPrevious();if(t){var i=this.getPosition(),e=p.call(this,t);this._scroller.sequenceFrom(t),this._node=t;var n=z>i?-e:0;f.call(this,n,M.PAGE),_.call(this,e)}return this._eventOutput.emit("pageChange",{direction:-1}),t},n.prototype.goToNextPage=function(){if(!this._node)return null;var t=this._node.getNext();if(t){var i=this.getPosition(),e=p.call(this,this._node),n=p.call(this,t);this._scroller.sequenceFrom(t),this._node=t;var s=i>e-z?e+n:e;f.call(this,s,M.PAGE),_.call(this,-e)}return this._eventOutput.emit("pageChange",{direction:1}),t},n.prototype.sequenceFrom=function(t){return t instanceof Array&&(t=new S({array:t})),this._node=t,this._scroller.sequenceFrom(t)},n.prototype.getSize=function(){return this._scroller.getSize.apply(this._scroller,arguments)},n.prototype.render=function(){return this._node?(d.call(this),u.call(this,this._scroller.onEdge()),this.options.paginated&&l.call(this),this._scroller.render()):null},e.exports=n}),define(function(t,i,e){function n(t){this._items=null,this._size=null,this._outputFunction=n.DEFAULT_OUTPUT_FUNCTION,this.options=Object.create(this.constructor.DEFAULT_OPTIONS),this.optionsManager=new s(this.options),this._itemsCache=[],this._outputCache={size:null,target:this._itemsCache},t&&this.setOptions(t)}var s=t("famous/core/OptionsManager"),o=t("famous/core/Transform"),r=t("famous/core/ViewSequence"),a=t("famous/utilities/Utility");n.DEFAULT_OPTIONS={direction:a.Direction.Y,itemSpacing:0,defaultItemSize:[50,50]},n.DEFAULT_OUTPUT_FUNCTION=function(t,i){var e=this.options.direction===a.Direction.X?o.translate(i,0):o.translate(0,i);return{transform:e,target:t.render()}},n.prototype.getSize=function(){return this._size||this.render(),this._size},n.prototype.sequenceFrom=function(t){return t instanceof Array&&(t=new r(t)),this._items=t,this},n.prototype.setOptions=function(){return this.optionsManager.setOptions.apply(this.optionsManager,arguments),this},n.prototype.setOutputFunction=function(t){return this._outputFunction=t,this},n.prototype.render=function(){for(var t=0,i=0,e=this.options.direction===a.Direction.X?0:1,n=this.options.direction===a.Direction.X?1:0,s=this._items,o=this._itemsCache,r=0;s;){var h=s.get();if(!h)break;var c;h&&h.getSize&&(c=h.getSize()),c||(c=this.options.defaultItemSize),c[n]!==!0&&(i=Math.max(i,c[n]));var p=this._outputFunction.call(this,h,t,r);o[r]=p,c[e]&&c[e]!==!0&&(t+=c[e]+this.options.itemSpacing),s=s.getNext(),r++}return this._itemsCache.splice(r),i||(i=void 0),this._size||(this._size=[0,0]),this._size[e]=t-this.options.itemSpacing,this._size[n]=i,this._outputCache.size=this.getSize(),this._outputCache},e.exports=n}),define(function(t,i,e){function n(t){s.call(this,t),t=t||{},this.orientation=new a,this.angularVelocity=new r,this.angularMomentum=new r,this.torque=new r,t.orientation&&this.orientation.set(t.orientation),t.angularVelocity&&this.angularVelocity.set(t.angularVelocity),t.angularMomentum&&this.angularMomentum.set(t.angularMomentum),t.torque&&this.torque.set(t.torque),this.setMomentsOfInertia(),this.angularVelocity.w=0,this.pWorld=new r}var s=t("./Particle"),o=t("famous/core/Transform"),r=t("famous/math/Vector"),a=t("famous/math/Quaternion"),h=t("famous/math/Matrix");n.DEFAULT_OPTIONS=s.DEFAULT_OPTIONS,n.DEFAULT_OPTIONS.orientation=[0,0,0,1],n.DEFAULT_OPTIONS.angularVelocity=[0,0,0],n.AXES=s.AXES,n.SLEEP_TOLERANCE=s.SLEEP_TOLERANCE,n.INTEGRATOR=s.INTEGRATOR,n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.isBody=!0,n.prototype.setMass=function(){s.prototype.setMass.apply(this,arguments),this.setMomentsOfInertia()},n.prototype.setMomentsOfInertia=function(){this.inertia=new h,this.inverseInertia=new h},n.prototype.updateAngularVelocity=function(){this.angularVelocity.set(this.inverseInertia.vectorMultiply(this.angularMomentum))},n.prototype.toWorldCoordinates=function(t){return this.pWorld.set(this.orientation.rotateVector(t))},n.prototype.getEnergy=function(){return s.prototype.getEnergy.call(this)+.5*this.inertia.vectorMultiply(this.angularVelocity).dot(this.angularVelocity)},n.prototype.reset=function(t,i,e,n){s.prototype.reset.call(this,t,i),this.angularVelocity.clear(),this.setOrientation(e||[1,0,0,0]),this.setAngularMomentum(n||[0,0,0])},n.prototype.setOrientation=function(t){this.orientation.set(t)},n.prototype.setAngularVelocity=function(t){this.wake(),this.angularVelocity.set(t)},n.prototype.setAngularMomentum=function(t){this.wake(),this.angularMomentum.set(t)},n.prototype.applyForce=function(t,i){s.prototype.applyForce.call(this,t),void 0!==i&&this.applyTorque(i.cross(t))},n.prototype.applyTorque=function(t){this.wake(),this.torque.set(this.torque.add(t))},n.prototype.getTransform=function(){return o.thenMove(this.orientation.getTransform(),o.getTranslate(s.prototype.getTransform.call(this)))},n.prototype._integrate=function(t){s.prototype._integrate.call(this,t),this.integrateAngularMomentum(t),this.updateAngularVelocity(t),this.integrateOrientation(t)},n.prototype.integrateAngularMomentum=function(t){n.INTEGRATOR.integrateAngularMomentum(this,t)},n.prototype.integrateOrientation=function(t){n.INTEGRATOR.integrateOrientation(this,t)},e.exports=n}),define(function(t,i,e){function n(t){t=t||{},this.setRadius(t.radius||0),s.call(this,t)}var s=t("./Body"),o=t("famous/math/Matrix");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.setRadius=function(t){this.radius=t,this.size=[2*this.radius,2*this.radius],this.setMomentsOfInertia()},n.prototype.setMomentsOfInertia=function(){var t=this.mass,i=this.radius;this.inertia=new o([[.25*t*i*i,0,0],[0,.25*t*i*i,0],[0,0,.5*t*i*i]]),this.inverseInertia=new o([[4/(t*i*i),0,0],[0,4/(t*i*i),0],[0,0,2/(t*i*i)]])},e.exports=n}),define(function(t,i,e){function n(t){t=t||{},this.position=new o,this.velocity=new o,this.force=new o;var i=n.DEFAULT_OPTIONS;this.setPosition(t.position||i.position),this.setVelocity(t.velocity||i.velocity),this.force.set(t.force||[0,0,0]),this.mass=void 0!==t.mass?t.mass:i.mass,this.axis=void 0!==t.axis?t.axis:i.axis,this.inverseMass=1/this.mass,this._isSleeping=!1,this._engine=null,this._eventOutput=null,this._positionGetter=null,this.transform=r.identity.slice(),this._spec={transform:this.transform,target:null}}function s(){this._eventOutput=new a,this._eventOutput.bindThis(this),a.setOutputHandler(this,this._eventOutput)}var o=t("famous/math/Vector"),r=t("famous/core/Transform"),a=t("famous/core/EventHandler"),h=t("../integrators/SymplecticEuler");n.DEFAULT_OPTIONS={position:[0,0,0],velocity:[0,0,0],mass:1,axis:void 0},n.SLEEP_TOLERANCE=1e-7,n.AXES={X:0,Y:1,Z:2},n.INTEGRATOR=new h;var c={start:"start",update:"update",end:"end"},p=function(){return Date.now}();n.prototype.sleep=function(){this._isSleeping||(this.emit(c.end,this),this._isSleeping=!0)},n.prototype.wake=function(){this._isSleeping&&(this.emit(c.start,this),this._isSleeping=!1,this._prevTime=p())},n.prototype.isBody=!1,n.prototype.setPosition=function(t){this.position.set(t)},n.prototype.setPosition1D=function(t){this.position.x=t},n.prototype.getPosition=function(){return this._positionGetter instanceof Function&&this.setPosition(this._positionGetter()),this._engine.step(),this.position.get()},n.prototype.getPosition1D=function(){return this._engine.step(),this.position.x},n.prototype.positionFrom=function(t){this._positionGetter=t},n.prototype.setVelocity=function(t){this.velocity.set(t),this.wake()},n.prototype.setVelocity1D=function(t){this.velocity.x=t,this.wake()},n.prototype.getVelocity=function(){return this.velocity.get()},n.prototype.getVelocity1D=function(){return this.velocity.x},n.prototype.setMass=function(t){this.mass=t,this.inverseMass=1/t},n.prototype.getMass=function(){return this.mass},n.prototype.reset=function(t,i){this.setPosition(t||[0,0,0]),this.setVelocity(i||[0,0,0])},n.prototype.applyForce=function(t){t.isZero()||(this.force.add(t).put(this.force),this.wake())},n.prototype.applyImpulse=function(t){if(!t.isZero()){var i=this.velocity;i.add(t.mult(this.inverseMass)).put(i)}},n.prototype.integrateVelocity=function(t){n.INTEGRATOR.integrateVelocity(this,t)},n.prototype.integratePosition=function(t){n.INTEGRATOR.integratePosition(this,t)},n.prototype._integrate=function(t){this.integrateVelocity(t),this.integratePosition(t)},n.prototype.getEnergy=function(){return.5*this.mass*this.velocity.normSquared()},n.prototype.getTransform=function(){this._engine.step();var t=this.position,i=this.axis,e=this.transform;return void 0!==i&&(i&~n.AXES.X&&(t.x=0),i&~n.AXES.Y&&(t.y=0),i&~n.AXES.Z&&(t.z=0)),e[12]=t.x,e[13]=t.y,e[14]=t.z,e},n.prototype.modify=function(t){var i=this._spec;return i.transform=this.getTransform(),i.target=t,i},n.prototype.emit=function(t,i){this._eventOutput&&this._eventOutput.emit(t,i)},n.prototype.on=function(){return s.call(this),this.on.apply(this,arguments)},n.prototype.removeListener=function(){return s.call(this),this.removeListener.apply(this,arguments)},n.prototype.pipe=function(){return s.call(this),this.pipe.apply(this,arguments)},n.prototype.unpipe=function(){return s.call(this),this.unpipe.apply(this,arguments)},e.exports=n}),define(function(t,i,e){function n(t){t=t||{},this.size=t.size||[0,0],s.call(this,t)}var s=t("./Body"),o=t("famous/math/Matrix");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.setSize=function(t){this.size=t,this.setMomentsOfInertia()},n.prototype.setMomentsOfInertia=function(){var t=this.mass,i=this.size[0],e=this.size[1];this.inertia=new o([[t*e*e/12,0,0],[0,t*i*i/12,0],[0,0,t*(i*i+e*e)/12]]),this.inverseInertia=new o([[12/(t*e*e),0,0],[0,12/(t*i*i),0],[0,0,12/(t*(i*i+e*e))]])},e.exports=n}),define(function(t,i,e){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),t&&this.setOptions(t),this.normal=new o,this.pDiff=new o,this.vDiff=new o,this.impulse1=new o,this.impulse2=new o,s.call(this)}var s=t("./Constraint"),o=t("famous/math/Vector");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={restitution:.5,drift:.5,slop:0},n.prototype.setOptions=function(t){for(var i in t)this.options[i]=t[i]},n.prototype.applyConstraint=function(t,i,e){if(void 0!==i)for(var n=i.velocity,s=i.position,o=i.inverseMass,r=i.radius,a=this.options,h=a.drift,c=-a.slop,p=a.restitution,u=this.normal,l=this.pDiff,f=this.vDiff,d=this.impulse1,_=this.impulse2,y=0;y<t.length;y++){var g=t[y];if(g!==i){var v=g.velocity,m=g.position,O=g.inverseMass,T=g.radius;l.set(m.sub(s)),f.set(v.sub(n));var S=l.norm(),w=S-(r+T),b=1/(o+O),I=0;if(0>w){if(u.set(l.normalize()),this._eventOutput){var E={target:g,source:i,overlap:w,normal:u};this._eventOutput.emit("preCollision",E),this._eventOutput.emit("collision",E)}var x=c>=w?((1+p)*u.dot(f)+h/e*(w-c))/(I+e/b):(1+p)*u.dot(f)/(I+e/b);u.mult(e*x).put(d),d.mult(-1).put(_),i.applyImpulse(d),g.applyImpulse(_),this._eventOutput&&this._eventOutput.emit("postCollision",E)}}}},e.exports=n}),define(function(t,i,e){function n(){this.options=this.options||{},this._energy=0,this._eventOutput=null}function s(){this._eventOutput=new o,this._eventOutput.bindThis(this),o.setOutputHandler(this,this._eventOutput)}var o=t("famous/core/EventHandler");n.prototype.setOptions=function(t){for(var i in t)this.options[i]=t[i]},n.prototype.applyConstraint=function(){},n.prototype.getEnergy=function(){return this._energy},n.prototype.setEnergy=function(t){this._energy=t},n.prototype.on=function(){return s.call(this),this.on.apply(this,arguments)},n.prototype.addListener=function(){return s.call(this),this.addListener.apply(this,arguments)},n.prototype.pipe=function(){return s.call(this),this.pipe.apply(this,arguments)},n.prototype.removeListener=function(){return this.removeListener.apply(this,arguments)},n.prototype.unpipe=function(){return this.unpipe.apply(this,arguments)},e.exports=n}),define(function(t,i,e){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),t&&this.setOptions(t),this.J=new o,this.impulse=new o,s.call(this)}var s=t("./Constraint"),o=t("famous/math/Vector");n.prototype=Object.create(s.prototype),n.prototype.constructor=n;var r=1e-7,a=Math.PI;n.DEFAULT_OPTIONS={equation:function(){return 0},plane:function(t,i,e){return e},period:0,dampingRatio:0},n.prototype.setOptions=function(t){for(var i in t)this.options[i]=t[i]},n.prototype.applyConstraint=function(t,i,e){for(var n=this.options,s=this.impulse,o=this.J,h=n.equation,c=n.plane,p=n.dampingRatio,u=n.period,l=0;l<t.length;l++){var f,d,_=t[l],y=_.velocity,g=_.position,v=_.mass;if(0===u)f=0,d=1;else{var m=4*v*a*p/u,O=4*v*a*a/(u*u);f=1/(m+e*O),d=e*O/(m+e*O)}var T=g.x,S=g.y,w=g.z,b=h(T,S,w),I=(h(T+r,g,g)-b)/r,E=(h(T,S+r,g)-b)/r,x=(h(T,S,g+r)-b)/r,z=c(T,S,w),M=(c(T+r,S,w)-z)/r,C=(c(T,S+r,w)-z)/r,P=(c(T,S,w+r)-z)/r;o.setXYZ(I+M,E+C,x+P);var F=d/e*(b+z),N=-(o.dot(y)+F)/(f+e*o.normSquared()/v);s.set(o.mult(e*N)),_.applyImpulse(s)}},e.exports=n}),define(function(t,i,e){function n(t){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),t&&this.setOptions(t),this.pDiff=new r,this.vDiff=new r,this.impulse1=new r,this.impulse2=new r,o.call(this)}function s(t,i,e){return Math.abs(t.dot(i)/e)}var o=t("./Constraint"),r=t("famous/math/Vector");n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={period:300,dampingRatio:.1,length:0,anchor:void 0};var a=Math.PI;n.prototype.setOptions=function(t){void 0!==t.anchor&&(t.anchor instanceof r&&(this.options.anchor=t.anchor),t.anchor.position instanceof r&&(this.options.anchor=t.anchor.position),t.anchor instanceof Array&&(this.options.anchor=new r(t.anchor))),void 0!==t.length&&(this.options.length=t.length),void 0!==t.dampingRatio&&(this.options.dampingRatio=t.dampingRatio),void 0!==t.period&&(this.options.period=t.period)},n.prototype.setAnchor=function(t){void 0!==this.options.anchor&&(this.options.anchor=new r),this.options.anchor.set(t)},n.prototype.getEnergy=function(t,i){var e=this.options,n=e.length,s=e.anchor||i.position,o=Math.pow(2*a/e.period,2),r=s.sub(t.position).norm()-n;return.5*o*r*r},n.prototype.applyConstraint=function(t,i,e){for(var n=this.options,o=this.pDiff,r=this.vDiff,h=this.impulse1,c=this.impulse2,p=n.length,u=n.anchor||i.position,l=n.period,f=n.dampingRatio,d=0;d<t.length;d++){var _=t[d],y=_.position,g=_.velocity,v=_.mass,m=_.inverseMass;o.set(y.sub(u));var O,T=o.norm()-p;if(i){var S=i.inverseMass,w=i.velocity;r.set(g.sub(w)),O=1/(m+S)}else r.set(g),O=v;var b,I;if(0===this.options.period)b=0,I=1;else{var E=4*O*a*a/(l*l),x=4*O*a*f/l;I=e*E/(x+e*E),b=1/(x+e*E)}var z=I/e*T;o.normalize(-z).sub(r).mult(e/(b+e/O)).put(h),_.applyImpulse(h),i&&(h.mult(-1).put(c),i.applyImpulse(c)),this.setEnergy(s(h,o,e))}},e.exports=n}),define(function(t,i,e){function n(t){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),t&&this.setOptions(t),this.impulse=new o,this.normal=new o,this.diffP=new o,this.diffV=new o,s.call(this)}var s=t("./Constraint"),o=t("famous/math/Vector");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={anchor:null,length:0,minLength:0,period:0,dampingRatio:0};var r=Math.PI;n.prototype.setOptions=function(t){t.anchor&&(t.anchor.position instanceof o&&(this.options.anchor=t.anchor.position),t.anchor instanceof o&&(this.options.anchor=t.anchor),t.anchor instanceof Array&&(this.options.anchor=new o(t.anchor))),void 0!==t.length&&(this.options.length=t.length),void 0!==t.dampingRatio&&(this.options.dampingRatio=t.dampingRatio),void 0!==t.period&&(this.options.period=t.period),void 0!==t.minLength&&(this.options.minLength=t.minLength)},n.prototype.setAnchor=function(t){this.options.anchor||(this.options.anchor=new o),this.options.anchor.set(t)},n.prototype.applyConstraint=function(t,i,e){var n,s,o=this.normal,a=this.diffP,h=this.diffV,c=this.impulse,p=this.options,u=p.dampingRatio,l=p.period,f=p.minLength;if(i){var d=i.velocity;n=i.position,s=i.inverseMass}else n=this.options.anchor,s=0;for(var _=this.options.length,y=0;y<t.length;y++){var g=t[y],v=g.velocity,m=g.position,O=g.inverseMass;a.set(m.sub(n)),o.set(a.normalize());var T=a.norm()-_;if(Math.abs(T)<f)return;h.set(i?v.sub(d):v);var S,w,b=1/(O+s);if(0===l)S=0,w=1;else{var I=4*b*r*u/l,E=4*b*r*r/(l*l);S=1/(I+e*E),w=e*E/(I+e*E)}var x=w/e*T,z=-(o.dot(h)+x)/(S+e/b);c.set(o.mult(e*z)),g.applyImpulse(c),i&&i.applyImpulse(c.mult(-1))}},e.exports=n}),define(function(t,i,e){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),t&&this.setOptions(t),this.J=new o,this.impulse=new o,s.call(this)}var s=t("./Constraint"),o=t("famous/math/Vector");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={equation:void 0,period:0,dampingRatio:0};var r=1e-7,a=Math.PI;n.prototype.setOptions=function(t){for(var i in t)this.options[i]=t[i]},n.prototype.applyConstraint=function(t,i,e){for(var n=this.impulse,s=this.J,o=this.options,h=o.equation,c=o.dampingRatio,p=o.period,u=0;u<t.length;u++){var l,f,d=t[u],_=d.velocity,y=d.position,g=d.mass;if(0===p)l=0,f=1;else{var v=4*g*a*c/p,m=4*g*a*a/(p*p);l=1/(v+e*m),f=e*m/(v+e*m)}var O=y.x,T=y.y,S=y.z,w=h(O,T,S),b=(h(O+r,y,y)-w)/r,I=(h(O,T+r,y)-w)/r,E=(h(O,T,y+r)-w)/r;s.setXYZ(b,I,E);var x=f/e*w,z=-(s.dot(_)+x)/(l+e*s.normSquared()/g);n.set(s.mult(e*z)),d.applyImpulse(n)}},e.exports=n}),define(function(t,i,e){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),t&&this.setOptions(t),this.diff=new c,this.impulse=new c,h.call(this)}function s(t,i){return i.dot(t)}function o(t){var i=this.options.normal,e=this.options.distance;return t.dot(i)+e}function r(t,i,e){var s=t.position,o=t.velocity,r=t.mass,a=this.options.normal,h=this.options.onContact,c=this.options.restitution,p=this.impulse,u=this.options.drift,l=-this.options.slop,f=0;if(this._eventOutput){var d={particle:t,wall:this,overlap:i,normal:a};this._eventOutput.emit("preCollision",d),this._eventOutput.emit("collision",d)}switch(h){case n.ON_CONTACT.REFLECT:var _=l>i?-((1+c)*a.dot(o)+u/e*(i-l))/(r*e+f):-((1+c)*a.dot(o))/(r*e+f);p.set(a.mult(e*_)),t.applyImpulse(p),t.setPosition(s.add(a.mult(-i)))}this._eventOutput&&this._eventOutput.emit("postCollision",d)}function a(t,i){var e=this.options.onContact,s=t.position,o=this.options.normal;e===n.ON_CONTACT.REFLECT&&t.setPosition(s.add(o.mult(-i)))}var h=t("./Constraint"),c=t("famous/math/Vector");n.prototype=Object.create(h.prototype),n.prototype.constructor=n,n.ON_CONTACT={REFLECT:0,SILENT:1},n.DEFAULT_OPTIONS={restitution:.5,drift:.5,slop:0,normal:[1,0,0],distance:0,onContact:n.ON_CONTACT.REFLECT},n.prototype.setOptions=function(t){void 0!==t.normal&&(t.normal instanceof c&&(this.options.normal=t.normal.clone()),t.normal instanceof Array&&(this.options.normal=new c(t.normal))),void 0!==t.restitution&&(this.options.restitution=t.restitution),void 0!==t.drift&&(this.options.drift=t.drift),void 0!==t.slop&&(this.options.slop=t.slop),void 0!==t.distance&&(this.options.distance=t.distance),void 0!==t.onContact&&(this.options.onContact=t.onContact)},n.prototype.applyConstraint=function(t,i,e){for(var n=this.options.normal,h=0;h<t.length;h++){var c=t[h],p=c.position,u=c.velocity,l=c.radius||0,f=o.call(this,p.add(n.mult(-l))),d=s.call(this,n,u);0>=f&&(0>d?r.call(this,c,f,e):a.call(this,c,f,e))}},e.exports=n}),define(function(t,i,e){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),t&&this.setOptions(t),o.call(this,t.sides||this.options.sides),a.call(this)}function s(t,i,e){var s,o=n.SIDES;switch(parseInt(t)){case o.LEFT:s=i[0]*e[0];break;case o.TOP:s=i[1]*e[1];break;case o.FRONT:s=i[2]*e[2];break;case o.RIGHT:s=i[0]*(1-e[0]);break;case o.BOTTOM:s=i[1]*(1-e[1]);break;case o.BACK:s=i[2]*(1-e[2])}return s}function o(t){this.components={};for(var i=this.components,e=0;e<t.length;e++){var n=t[e];i[e]=new h({normal:p[n].clone(),distance:s(n,this.options.size,this.options.origin)})}}function r(t){this.forEach(function(i){i.setOptions(t)});for(var i in t)this.options[i]=t[i]}var a=t("./Constraint"),h=t("./Wall"),c=t("famous/math/Vector");n.prototype=Object.create(a.prototype),n.prototype.constructor=n,n.ON_CONTACT=h.ON_CONTACT,n.SIDES={LEFT:0,RIGHT:1,TOP:2,BOTTOM:3,FRONT:4,BACK:5,TWO_DIMENSIONAL:[0,1,2,3],THREE_DIMENSIONAL:[0,1,2,3,4,5]},n.DEFAULT_OPTIONS={sides:n.SIDES.TWO_DIMENSIONAL,size:[window.innerWidth,window.innerHeight,0],origin:[.5,.5,.5],drift:.5,slop:0,restitution:.5,onContact:n.ON_CONTACT.REFLECT};var p={0:new c(1,0,0),1:new c(-1,0,0),2:new c(0,1,0),3:new c(0,-1,0),4:new c(0,0,1),5:new c(0,0,-1)};n.prototype.setOptions=function(t){var i=!1;void 0!==t.restitution&&r.call(this,{restitution:t.restitution}),void 0!==t.drift&&r.call(this,{drift:t.drift}),void 0!==t.slop&&r.call(this,{slop:t.slop}),void 0!==t.onContact&&r.call(this,{onContact:t.onContact}),void 0!==t.size&&(i=!0),void 0!==t.sides&&(this.options.sides=t.sides),void 0!==t.origin&&(i=!0),i&&this.setSize(t.size,t.origin)},n.prototype.setSize=function(t,i){i=i||this.options.origin,i.length<3&&(i[2]=.5),this.forEach(function(e,n){var o=s(n,t,i);e.setOptions({distance:o})}),this.options.size=t,this.options.origin=i},n.prototype.applyConstraint=function(t,i,e){this.forEach(function(n){n.applyConstraint(t,i,e)})},n.prototype.forEach=function(t){var i=this.options.sides;for(var e in this.sides)t(i[e],e)},n.prototype.rotateZ=function(t){this.forEach(function(i){var e=i.options.normal;e.rotateZ(t).put(e)})},n.prototype.rotateX=function(t){this.forEach(function(i){var e=i.options.normal;e.rotateX(t).put(e)})},n.prototype.rotateY=function(t){this.forEach(function(i){var e=i.options.normal;e.rotateY(t).put(e)})},e.exports=n}),define(function(t,i,e){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),this._optionsManager=new s(this.options),t&&this.setOptions(t)}var s=t("famous/core/OptionsManager");n.DEFAULT_OPTIONS={velocityCap:void 0,angularVelocityCap:void 0},n.prototype.setOptions=function(t){this._optionsManager.patch(t)},n.prototype.getOptions=function(){return this._optionsManager.value()},n.prototype.integrateVelocity=function(t,i){var e=t.velocity,n=t.inverseMass,s=t.force;s.isZero()||(e.add(s.mult(i*n)).put(e),s.clear())},n.prototype.integratePosition=function(t,i){var e=t.position,n=t.velocity;this.options.velocityCap&&n.cap(this.options.velocityCap).put(n),e.add(n.mult(i)).put(e)},n.prototype.integrateAngularMomentum=function(t,i){var e=t.angularMomentum,n=t.torque;n.isZero()||(this.options.angularVelocityCap&&n.cap(this.options.angularVelocityCap).put(n),e.add(n.mult(i)).put(e),n.clear())},n.prototype.integrateOrientation=function(t,i){var e=t.orientation,n=t.angularVelocity;n.isZero()||e.add(e.multiply(n).scalarMultiply(.5*i)).put(e)},e.exports=n}),define(function(t,i,e){function n(t){this.force=new o(t),this._energy=0,this._eventOutput=null}function s(){this._eventOutput=new r,this._eventOutput.bindThis(this),r.setOutputHandler(this,this._eventOutput)}var o=t("famous/math/Vector"),r=t("famous/core/EventHandler");n.prototype.setOptions=function(t){for(var i in t)this.options[i]=t[i]},n.prototype.applyForce=function(t){t.applyForce(this.force)},n.prototype.getEnergy=function(){return this._energy},n.prototype.setEnergy=function(t){this._energy=t},n.prototype.on=function(){return s.call(this),this.on.apply(this,arguments)},n.prototype.addListener=function(){return s.call(this),this.addListener.apply(this,arguments)},n.prototype.pipe=function(){return s.call(this),this.pipe.apply(this,arguments)},n.prototype.removeListener=function(){return this.removeListener.apply(this,arguments)},n.prototype.unpipe=function(){return this.unpipe.apply(this,arguments)},e.exports=n}),define(function(t,i,e){function n(t){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),t&&this.setOptions(t),s.call(this)}var s=t("./Force");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.FORCE_FUNCTIONS={LINEAR:function(t){return t},QUADRATIC:function(t){return t.mult(t.norm())}},n.DEFAULT_OPTIONS={strength:.01,forceFunction:n.FORCE_FUNCTIONS.LINEAR},n.prototype.applyForce=function(t){for(var i=this.options.strength,e=this.options.forceFunction,n=this.force,s=0;s<t.length;s++){var o=t[s];e(o.velocity).mult(-i).put(n),o.applyForce(n)}},n.prototype.setOptions=function(t){for(var i in t)this.options[i]=t[i]},e.exports=n}),define(function(t,i,e){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),t&&this.setOptions(t),this.disp=new o,s.call(this)}var s=t("./Force"),o=t("famous/math/Vector");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.DECAY_FUNCTIONS={LINEAR:function(t,i){return Math.max(1-1/i*t,0)
},MORSE:function(t,i){var e=0===i?100:i,n=t+e*(1-Math.log(2));return Math.max(1-Math.pow(1-Math.exp(n/e-1),2),0)},INVERSE:function(t,i){return 1/(1-i+t)},GRAVITY:function(t,i){return 1/(1-i+t*t)}},n.DEFAULT_OPTIONS={strength:1,anchor:void 0,range:[0,1/0],cutoff:0,cap:1/0,decayFunction:n.DECAY_FUNCTIONS.GRAVITY},n.prototype.setOptions=function(t){void 0!==t.anchor&&(t.anchor.position instanceof o&&(this.options.anchor=t.anchor.position),t.anchor instanceof Array&&(this.options.anchor=new o(t.anchor)),delete t.anchor);for(var i in t)this.options[i]=t[i]},n.prototype.applyForce=function(t,i){var e=this.options,n=this.force,s=this.disp,o=e.strength,r=e.anchor||i.position,a=e.cap,h=e.cutoff,c=e.range[0],p=e.range[1],u=e.decayFunction;if(0!==o)for(var l in t){var f=t[l];if(f!==i){var d=f.mass,_=f.position;s.set(_.sub(r));var y=s.norm();p>y&&y>c&&(n.set(s.normalize(o*d*u(y,h)).cap(a)),f.applyForce(n))}}},e.exports=n}),define(function(t,i,e){function n(t){s.call(this,t)}var s=t("./Drag");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS=s.DEFAULT_OPTIONS,n.FORCE_FUNCTIONS=s.FORCE_FUNCTIONS,n.FORCE_FUNCTIONS={LINEAR:function(t){return t},QUADRATIC:function(t){return t.mult(t.norm())}},n.prototype.applyForce=function(t){for(var i=this.options.strength,e=this.options.forceFunction,n=this.force,s=0;s<t.length;s++){var o=t[s];e(o.angularVelocity).mult(-100*i).put(n),o.applyTorque(n)}},n.prototype.setOptions=function(t){for(var i in t)this.options[i]=t[i]},e.exports=n}),define(function(t,i,e){function n(t){s.call(this,t)}var s=t("./Spring");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS=s.DEFAULT_OPTIONS,n.FORCE_FUNCTIONS=s.FORCE_FUNCTIONS,n.prototype.applyForce=function(t){for(var i=this.force,e=this.options,n=this.disp,s=e.stiffness,o=e.damping,r=e.length,a=e.anchor,h=0;h<t.length;h++){var c=t[h];n.set(a.sub(c.orientation));var p=n.norm()-r;if(0===p)return;var u=c.mass;s*=u,o*=u,i.set(n.normalize(s*this.forceFunction(p,this.options.lMax))),o&&i.set(i.add(c.angularVelocity.mult(-o))),c.applyTorque(i)}},n.prototype.getEnergy=function(t){var i=this.options,e=i.length,n=i.anchor,s=i.stiffness,o=n.sub(t.orientation).norm()-e;return.5*s*o*o},e.exports=n}),define(function(t,i,e){function n(t){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),t&&this.setOptions(t),this.disp=new p(0,0,0),h.call(this),c.call(this)}function s(t){this.forceFunction=t}function o(){var t=this.options;t.stiffness=Math.pow(2*u/t.period,2)}function r(){var t=this.options;t.damping=4*u*t.dampingRatio/t.period}function a(t,i){return.5*t*i*i}function h(){s.call(this,this.options.forceFunction),o.call(this),r.call(this)}var c=t("./Force"),p=t("famous/math/Vector");n.prototype=Object.create(c.prototype),n.prototype.constructor=n;var u=Math.PI;n.FORCE_FUNCTIONS={FENE:function(t,i){var e=.99*i,n=Math.max(Math.min(t,e),-e);return n/(1-n*n/(i*i))},HOOK:function(t){return t}},n.DEFAULT_OPTIONS={period:300,dampingRatio:.1,length:0,maxLength:1/0,anchor:void 0,forceFunction:n.FORCE_FUNCTIONS.HOOK},n.prototype.setOptions=function(t){void 0!==t.anchor&&(t.anchor.position instanceof p&&(this.options.anchor=t.anchor.position),t.anchor instanceof p&&(this.options.anchor=t.anchor),t.anchor instanceof Array&&(this.options.anchor=new p(t.anchor))),void 0!==t.period&&(this.options.period=t.period),void 0!==t.dampingRatio&&(this.options.dampingRatio=t.dampingRatio),void 0!==t.length&&(this.options.length=t.length),void 0!==t.forceFunction&&(this.options.forceFunction=t.forceFunction),void 0!==t.maxLength&&(this.options.maxLength=t.maxLength),h.call(this)},n.prototype.applyForce=function(t,i){for(var e=this.force,n=this.disp,s=this.options,o=s.stiffness,r=s.damping,h=s.length,c=s.maxLength,p=s.anchor||i.position,u=0;u<t.length;u++){var l=t[u],f=l.position,d=l.velocity;p.sub(f).put(n);var _=n.norm()-h;if(0===_)return;var y=l.mass;o*=y,r*=y,n.normalize(o*this.forceFunction(_,c)).put(e),r&&(i?e.add(d.sub(i.velocity).mult(-r)).put(e):e.add(d.mult(-r)).put(e)),l.applyForce(e),i&&i.applyForce(e.mult(-1)),this.setEnergy(a(o,_))}},n.prototype.getEnergy=function(t){var i=this.options,e=i.length,n=i.anchor,s=i.stiffness,o=n.sub(t.position).norm()-e;return.5*s*o*o},n.prototype.setAnchor=function(t){this.options.anchor||(this.options.anchor=new p),this.options.anchor.set(t)},e.exports=n}),define(function(t,i,e){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),t&&this.setOptions(t),s.call(this,this.options.field),r.call(this),this.evaluation=new a(0,0,0)}function s(t){var i=n.FIELDS;switch(t){case i.CONSTANT:this.options.direction||(this.options.direction=new a(0,1,0));break;case i.POINT_ATTRACTOR:this.options.position||(this.options.position=new a(0,0,0));break;case i.SPHERE_ATTRACTOR:this.options.radius||(this.options.radius=1)}}function o(t){var i=this.evaluation,e=this.options.field;return i.set(t),e(i,this.options)}var r=t("./Force"),a=t("famous/math/Vector");n.prototype=Object.create(r.prototype),n.prototype.constructor=n,n.FIELDS={CONSTANT:function(t,i){return t.set(i.direction)},LINEAR:function(t){return t},RADIAL:function(t){return t.set(t.mult(-1,t))},SPHERE_ATTRACTOR:function(t,i){return t.set(t.mult((i.radius-t.norm())/t.norm()))},POINT_ATTRACTOR:function(t,i){return t.set(i.position.sub(t))}},n.DEFAULT_OPTIONS={strength:1,field:n.FIELDS.CONSTANT},n.prototype.setOptions=function(t){for(var i in t)this.options[i]=t[i]},n.prototype.applyForce=function(t){for(var i=this.force,e=0;e<t.length;e++){var n=t[e];i.set(o.call(this,n.position).mult(n.mass*this.options.strength)),n.applyForce(i)}},e.exports=n});